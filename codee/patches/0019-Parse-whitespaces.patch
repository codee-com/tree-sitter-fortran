From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?I=C3=B1aki=20Amatria=20Barral?= <inaki.amatria@appentra.com>
Date: Mon, 27 Oct 2025 17:25:49 +0100
Subject: Parse whitespaces

---
 grammar.js                         |   12 +
 src/scanner.c                      |   35 +-
 test/corpus/constructs.txt         |  810 +++++++++++++-
 test/corpus/cudafortran.txt        |   39 +-
 test/corpus/expressions.txt        |  675 ++++++++++-
 test/corpus/line_continuations.txt |  117 +-
 test/corpus/preprocessor.txt       |  339 +++++-
 test/corpus/regressions.txt        |  140 ++-
 test/corpus/statements.txt         | 1660 +++++++++++++++++++++++++++-
 9 files changed, 3744 insertions(+), 83 deletions(-)

diff --git a/grammar.js b/grammar.js
index c8ce7d9..a546930 100644
--- a/grammar.js
+++ b/grammar.js
@@ -68,12 +68,14 @@ module.exports = grammar({
     $._preproc_unary_operator,
     $.hollerith_constant,
     $.macro_identifier,
+    $.whitespace,
   ],
 
   extras: $ => [
     // This allows escaping newlines everywhere, although this is only valid in
     // preprocessor statements
     /\s|\\\r?\n/,
+    $.whitespace,
     $.comment,
     $.multiline_preproc_comment,
     '&',
@@ -160,6 +162,16 @@ module.exports = grammar({
     preproc_def: $ => seq(
       preprocessor('define'),
       field('name', $.identifier),
+      // HACK: This `optional($.whitespace)` is a workaround to prevent
+      // `tree-sitter` from misinterpreting `#define FOO (bar * baz)` as a
+      // `preproc_function_def`. For reasons related to how `token.immediate()`
+      // detects adjacent tokens, explicitly naming the whitespace rule causes
+      // the parser to think the opening parenthesis after `FOO` is immediately
+      // following it, which makes it match the function-like form instead of
+      // the object-like one. Adding an optional `whitespace` node here breaks
+      // that ambiguity and forces `tree-sitter` to correctly parse it as a
+      // regular `preproc_def`
+      optional($.whitespace),
       field('value', optional($.preproc_arg)),
       $._external_end_of_statement,
     ),
diff --git a/src/scanner.c b/src/scanner.c
index e5a37ee..5fabf79 100644
--- a/src/scanner.c
+++ b/src/scanner.c
@@ -15,6 +15,7 @@ enum TokenType {
     PREPROC_UNARY_OPERATOR,
     HOLLERITH_CONSTANT,
     MACRO_IDENTIFIER,
+    WHITESPACE,
 };
 
 typedef Array(char *) StringArray;
@@ -451,10 +452,28 @@ static bool scan_preproc_unary_operator(TSLexer *lexer) {
   return false;
 }
 
+static bool is_horizontal_whitespace(int32_t c) {
+    return c == ' ' || c == '\t';
+}
+
+static bool scan_horizontal_whitespace(TSLexer *lexer) {
+    if (!is_horizontal_whitespace(lexer->lookahead)) {
+        return false;
+    }
+    while (is_horizontal_whitespace(lexer->lookahead)) {
+        advance(lexer);
+    }
+    lexer->mark_end(lexer);
+    lexer->result_symbol = WHITESPACE;
+    return true;
+}
+
 static bool scan(Scanner *scanner, TSLexer *lexer, const bool *valid_symbols) {
-    // Consume any leading whitespace except newlines
-    while (iswblank(lexer->lookahead)) {
-        skip(lexer);
+    if (valid_symbols[WHITESPACE]) {
+        // Consume any leading whitespace except newlines
+        if (scan_horizontal_whitespace(lexer)) {
+            return true;
+        }
     }
 
     // Close the current statement if we can
@@ -468,6 +487,16 @@ static bool scan(Scanner *scanner, TSLexer *lexer, const bool *valid_symbols) {
     // statements, so we should eat all whitespace including
     // newlines, until we come to something more interesting
     while (iswspace(lexer->lookahead)) {
+        if (valid_symbols[WHITESPACE]) {
+            // If whitespace tokens are valid, emit them explicitly
+            if (scan_horizontal_whitespace(lexer)) {
+                return true;
+            }
+        } else if (is_horizontal_whitespace(lexer->lookahead)) {
+            // Otherwise, `assert` if we encounter horizontal whitespace that
+            // would be skipped silently (likely a bug)
+            assert(false && "Silently skipping horizontal whitespace!!");
+        }
         skip(lexer);
     }
 
diff --git a/test/corpus/constructs.txt b/test/corpus/constructs.txt
index cb771ab..f05081f 100644
--- a/test/corpus/constructs.txt
+++ b/test/corpus/constructs.txt
@@ -13,15 +13,20 @@ END PROGRAM TEST
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_program_statement
+      (whitespace)
       (end_of_statement)))
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -77,35 +82,55 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (private_statement)
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (name)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (math_expression
           (call_expression
             (identifier)
@@ -116,18 +141,27 @@ end module
             (argument_list
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (concatenation_expression
           (call_expression
             (identifier)
@@ -135,14 +169,20 @@ end module
               (number_literal)))
           (prefixed_string_literal
             (string_literal)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (concatenation_expression
           (call_expression
             (identifier)
@@ -150,14 +190,20 @@ end module
               (number_literal)))
           (prefixed_string_literal
             (string_literal)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (concatenation_expression
           (call_expression
             (identifier)
@@ -165,52 +211,81 @@ end module
               (number_literal)))
           (prefixed_string_literal
             (string_literal)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (function
         (function_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (number_literal)))
+          (whitespace)
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (function
         (function_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -236,19 +311,26 @@ end interface
   (interface
     (interface_statement
       (end_of_statement))
+    (whitespace)
     (subroutine
       (subroutine_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier)
         (sized_declarator
           (identifier)
@@ -256,37 +338,57 @@ end interface
             (number_literal)
             (number_literal))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (function
       (function_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_function_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -312,20 +414,28 @@ end interface
   (interface
     (interface_statement
       (abstract_specifier)
+      (whitespace)
       (end_of_statement))
+    (whitespace)
     (subroutine
       (subroutine_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier)
         (sized_declarator
           (identifier)
@@ -333,37 +443,57 @@ end interface
             (number_literal)
             (number_literal))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (function
       (function_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_function_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -380,17 +510,25 @@ end interface
 (translation_unit
   (interface
     (interface_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -415,49 +553,78 @@ end interface operator (.not.)
 (translation_unit
   (interface
     (interface_statement
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
     (end_interface_statement
+      (whitespace)
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement)))
   (interface
     (interface_statement
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
     (function
       (function_statement
+        (whitespace)
         (name)
         (parameters
           (identifier))
         (end_of_statement))
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_function_statement
+        (whitespace)
         (end_of_statement)))
     (end_interface_statement
+      (whitespace)
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement))))
 
@@ -474,14 +641,22 @@ end interface assignment (=)
 (translation_unit
   (interface
     (interface_statement
-      (assignment)
+      (whitespace)
+      (assignment
+        (whitespace))
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
     (end_interface_statement
-      (assignment)
+      (whitespace)
+      (whitespace)
+      (assignment
+        (whitespace))
       (end_of_statement))))
 
 ================================================================================
@@ -495,14 +670,22 @@ interface operator(+) ; module procedure test_plus ; end interface
 (translation_unit
   (interface
     (interface_statement
+      (whitespace)
       (operator
         (operator_name))
+      (whitespace)
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
+    (whitespace)
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -520,24 +703,36 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (operator
           (operator_name))
+        (whitespace)
         (assignment)))
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (assignment))
     (end_of_statement)
+    (whitespace)
     (private_statement
+      (whitespace)
       (operator
         (operator_name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -580,119 +775,178 @@ END SUBROUTINE
   (subroutine
     (subroutine_statement
       (procedure_qualifier)
+      (whitespace)
       (procedure_qualifier)
+      (whitespace)
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (language_binding
         (identifier))
       (end_of_statement))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (prefixed_string_literal
             (string_literal))))
       (end_of_statement))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
       (argument_list
         (prefixed_string_literal
           (string_literal))
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (assumed_size)))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (assumed_size)
               (assumed_size)))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (identifier))))
         (end_of_statement)
+        (whitespace)
         (keyword_statement)
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
           (end_of_statement))))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -733,101 +987,143 @@ end function
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (comment)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list)))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (comment)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (language_binding
         (identifier))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (prefixed_string_literal
             (string_literal))))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
+      (whitespace)
       (function_result
         (identifier))
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (prefixed_string_literal
             (string_literal))))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (prefixed_string_literal
             (string_literal))))
+      (whitespace)
       (function_result
         (identifier))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -861,88 +1157,141 @@ end function test
   (function
     (function_statement
       (procedure_qualifier)
+      (whitespace)
       (procedure_qualifier)
+      (whitespace)
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (function_result
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (number_literal)))
+          (whitespace)
           (init_declarator
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -984,161 +1333,262 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (end_type_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (access_specifier)
+        (whitespace)
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (end_of_statement)
+      (whitespace)
       (private_statement)
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
           (kind
             (number_literal)))
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
           (kind
             (identifier)))
+        (whitespace)
         (type_qualifier)
+        (whitespace)
         (type_qualifier
           (argument_list
             (extent_specifier)
+            (whitespace)
             (extent_specifier)
+            (whitespace)
             (extent_specifier)))
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (procedure
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute))
+        (whitespace)
+        (whitespace)
         (pointer_init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (null_literal)))
       (end_of_statement)
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute
             (identifier))
+          (whitespace)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (identifier))
+            (whitespace)
+            (whitespace)
             (method_name
               (name)))
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (assignment))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (operator
                 (operator_name)))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))
+          (whitespace)
           (binding
             (binding_name
               (identifier))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (abstract_specifier)
+        (whitespace)
+        (whitespace)
         (type_name)
         (derived_type_parameter_list
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal)))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
+          (whitespace)
           (kind
             (call_expression
               (identifier)
               (argument_list
                 (number_literal)))))
+        (whitespace)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
           (kind
             (identifier)))
+        (whitespace)
+        (whitespace)
         (sized_declarator
           (identifier)
           (size
             (identifier)
+            (whitespace)
             (identifier))))
       (end_of_statement)
+      (whitespace)
       (end_type_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1157,28 +1607,46 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         access: (access_specifier)
+        (whitespace)
         (abstract_specifier)
+        (whitespace)
+        (whitespace)
         name: (type_name)
         (end_of_statement))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         access: (access_specifier)
+        (whitespace)
         base: (base_type_specifier
           (identifier))
+        (whitespace)
+        (whitespace)
         name: (type_name)
         (end_of_statement))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1201,35 +1669,54 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
           (procedure_interface)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (interface
       (interface_statement
         (abstract_specifier)
+        (whitespace)
         (end_of_statement))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1250,28 +1737,45 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (private_statement)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1291,35 +1795,57 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (variable_declaration
         (procedure
           (procedure_interface)
+          (whitespace)
           (procedure_attribute))
+        (whitespace)
+        (whitespace)
         (pointer_init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (null_literal))
+        (whitespace)
         (pointer_init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (null_literal
             (identifier))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (procedure
           (procedure_interface)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute))
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1346,15 +1872,19 @@ END SUBMODULE ConstructorMethods_child
     (submodule_statement
       (module_name
         (name))
+      (whitespace)
       (name)
       (end_of_statement))
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement))
     (end_submodule_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (submodule
@@ -1363,15 +1893,19 @@ END SUBMODULE ConstructorMethods_child
         (name))
       (module_name
         (name))
+      (whitespace)
       (name)
       (end_of_statement))
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement))
     (end_submodule_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1402,6 +1936,7 @@ END MODULE BoundingBox_Method
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (private_statement)
@@ -1409,51 +1944,79 @@ END MODULE BoundingBox_Method
     (interface
       (interface_statement
         (end_of_statement))
+      (whitespace)
       (subroutine
         (subroutine_statement
           (procedure_qualifier)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (interface
       (interface_statement
         (end_of_statement))
+      (whitespace)
       (function
         (function_statement
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier))
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1480,43 +2043,65 @@ end module test
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (interface
       (interface_statement
         (abstract_specifier)
+        (whitespace)
         (end_of_statement))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (procedure
             (procedure_interface))
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (procedure
             (procedure_interface))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (procedure
             (intrinsic_type
@@ -1524,17 +2109,27 @@ end module test
                 (keyword_argument
                   (identifier)
                   (identifier)))))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (subroutine_call
+          (whitespace)
           (identifier)
           (argument_list))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1565,64 +2160,103 @@ end program block_demo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (block_construct
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)))
       (end_of_statement)
+      (whitespace)
       (print_statement
         (format_identifier)
+        (whitespace)
         (output_item_list
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (block_construct
         (block_label_start_expression)
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (init_declarator
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (print_statement
           (format_identifier)
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement)
+        (whitespace)
         (end_block_construct_statement
+          (whitespace)
+          (whitespace)
           (block_label)))
       (end_of_statement)
-      (end_block_construct_statement))
+      (whitespace)
+      (end_block_construct_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1642,22 +2276,41 @@ end module enumeration_mod
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (enumeration_type
       (enumeration_type_statement
+        (whitespace)
+        (whitespace)
         (access_specifier)
+        (whitespace)
+        (whitespace)
         (type_name))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
         (identifier))
+      (whitespace)
       (end_enumeration_type_statement
+        (whitespace)
+        (whitespace)
+        (whitespace)
         (name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1718,198 +2371,331 @@ Block Data (Obsolescent)
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
diff --git a/test/corpus/cudafortran.txt b/test/corpus/cudafortran.txt
index b351532..a0da1f4 100644
--- a/test/corpus/cudafortran.txt
+++ b/test/corpus/cudafortran.txt
@@ -13,22 +13,35 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_modification
       (variable_attributes)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -48,23 +61,33 @@ end function
   (function
     (function_statement
       (procedure_attributes)
+      (whitespace)
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (comment)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list)))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -85,9 +108,12 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
       (cuda_kernel_argument_list
         (number_literal)
@@ -95,7 +121,9 @@ end program
       (argument_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
       (cuda_kernel_argument_list
         (number_literal)
@@ -108,18 +136,27 @@ end program
       (argument_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
+      (whitespace)
       (cuda_kernel_argument_list
         (number_literal)
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier)
+        (whitespace)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
-            (identifier))))
+            (identifier)))
+        (whitespace))
       (argument_list
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
diff --git a/test/corpus/expressions.txt b/test/corpus/expressions.txt
index 870a02e..c4b4bfe 100644
--- a/test/corpus/expressions.txt
+++ b/test/corpus/expressions.txt
@@ -36,130 +36,214 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (number_literal)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (unary_expression
           (number_literal))
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (number_literal)
+        (whitespace)
         (unary_expression
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (boolean_literal
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -187,50 +271,78 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (concatenation_expression
         left: (prefixed_string_literal
           (string_literal))
@@ -241,19 +353,26 @@ END PROGRAM
             left: (identifier)
             right: (identifier)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         kind: (identifier)
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (prefixed_string_literal
         kind: (number_literal)
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -270,17 +389,25 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (boolean_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (boolean_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -299,33 +426,49 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         right: (array_literal
+          (whitespace)
           (number_literal)
+          (whitespace)
           (number_literal)
-          (number_literal))))
+          (whitespace)
+          (number_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         right: (array_literal
           (math_expression
             left: (number_literal)
             right: (number_literal))
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -333,37 +476,51 @@ end program
                 (identifier)
                 (argument_list
                   (number_literal)))))
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         right: (array_literal
           (unary_expression
             argument: (number_literal))
+          (whitespace)
           (number_literal)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       subroutine: (identifier)
       (argument_list
         (identifier)
+        (whitespace)
         (array_literal
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
-              (number_literal))))))
+              (number_literal)))
+          (whitespace))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -386,22 +543,30 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (extent_specifier)))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -409,8 +574,11 @@ END PROGRAM
           (extent_specifier
             (number_literal)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -419,16 +587,22 @@ END PROGRAM
             (number_literal)
             (number_literal)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (extent_specifier
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -442,14 +616,19 @@ END PROGRAM
               (number_literal)
               (identifier))
             (identifier))))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (identifier)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -457,8 +636,11 @@ END PROGRAM
                 (identifier)
                 (argument_list
                   (identifier)))))))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -471,9 +653,12 @@ END PROGRAM
                   (identifier)
                   (number_literal))))
             (identifier))))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -491,26 +676,37 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (pointer_association_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (pointer_association_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (pointer_association_statement
       (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -528,20 +724,28 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (derived_type_member_expression
         (identifier)
         (type_member)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (derived_type_member_expression
@@ -551,9 +755,12 @@ END PROGRAM
           (extent_specifier
             (number_literal)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -578,81 +785,131 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (unary_expression
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (unary_expression
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (math_expression
           (math_expression
             (identifier)
             (identifier))
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
             (parenthesized_expression
               (unary_expression
                 (number_literal)))))
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (number_literal)
+        (whitespace)
+        (whitespace)
         (math_expression
           (parenthesized_expression
             (math_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (identifier)))
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (unary_expression
         (math_expression
           (number_literal)
+          (whitespace)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -687,139 +944,245 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (parenthesized_expression
         (logical_expression
+          (whitespace)
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (parenthesized_expression
           (logical_expression
             (parenthesized_expression
               (relational_expression
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (identifier)))
+            (whitespace)
+            (whitespace)
             (parenthesized_expression
               (relational_expression
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (identifier)))))
+        (whitespace)
+        (whitespace)
         (boolean_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (number_literal)
         (number_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -841,29 +1204,43 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
           (math_expression
             left: (math_expression
               left: (number_literal)
+              (whitespace)
+              (whitespace)
               right: (identifier))
+            (whitespace)
+            (whitespace)
             right: (math_expression
               left: (identifier)
               right: (identifier))))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (math_expression
         left: (call_expression
           (identifier)
@@ -875,28 +1252,41 @@ END PROGRAM
                   (math_expression
                     left: (identifier)
                     right: (identifier))
+                  (whitespace)
                   (number_literal)))
+              (whitespace)
+              (whitespace)
               right: (number_literal))))
+        (whitespace)
+        (whitespace)
         right: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       subroutine: (identifier)
       (argument_list
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
@@ -907,8 +1297,11 @@ END PROGRAM
                 (number_literal)
                 (identifier)))))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
@@ -928,6 +1321,7 @@ END PROGRAM
               (number_literal))))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -944,15 +1338,20 @@ end program use_type_bound_procedures
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (derived_type_member_expression
         (identifier)
         (type_member))
       (argument_list))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (derived_type_member_expression
         (derived_type_member_expression
           (call_expression
@@ -964,6 +1363,8 @@ end program use_type_bound_procedures
       (argument_list))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -986,30 +1387,49 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
+      (whitespace)
       (comment)
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
+      (whitespace)
       (comment)
+      (whitespace)
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (comment)
-    (stop_statement)
+    (whitespace)
+    (stop_statement
+      (whitespace)
+      (whitespace)
+      (whitespace))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1026,15 +1446,20 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1059,43 +1484,70 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
+        (whitespace)
         (ERROR
           (number_literal))
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (array_literal
           (ERROR
+            (number_literal)
+            (whitespace)
+            (whitespace)
             (number_literal))
+          (whitespace)
           (identifier)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal)))
+          (whitespace)
           (ERROR
+            (whitespace)
             (implicit_range_letter)
             (implicit_range_letter)
             (implicit_range_letter)
+            (whitespace))
+          (whitespace)
+          (ERROR
             (ERROR
               (number_literal))
             (user_defined_operator_name)
             (number_literal))
+          (whitespace)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1121,34 +1573,54 @@ end program array_constructors
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (array_literal
+          (whitespace)
           (implied_do_loop_expression
             (identifier)
+            (whitespace)
             (loop_control_expression
               (identifier)
               (number_literal)
-              (number_literal)))))
+              (whitespace)
+              (number_literal)))
+          (whitespace)))
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (array_literal
           (implied_do_loop_expression
             (identifier)
+            (whitespace)
             (intrinsic_type
               (kind
                 (keyword_argument
@@ -1159,15 +1631,22 @@ end program array_constructors
               (number_literal)
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (array_literal
         (implied_do_loop_expression
           (parenthesized_expression
@@ -1177,20 +1656,31 @@ end program array_constructors
                 (argument_list
                   (math_expression
                     (identifier)
+                    (whitespace)
+                    (whitespace)
                     (number_literal))))
+              (whitespace)
+              (whitespace)
               (number_literal)))
+          (whitespace)
           (loop_control_expression
             (identifier)
             (number_literal)
+            (whitespace)
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (array_literal
         (intrinsic_type)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
@@ -1200,24 +1690,34 @@ end program array_constructors
                 (kind
                   (identifier)))
               (number_literal)
+              (whitespace)
               (number_literal)
+              (whitespace)
               (number_literal)
+              (whitespace)
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
           (argument_list
             (array_literal
               (number_literal)
+              (whitespace)
               (number_literal)
+              (whitespace)
               (number_literal)
+              (whitespace)
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (array_literal
           (intrinsic_type
@@ -1225,14 +1725,20 @@ end program array_constructors
               (keyword_argument
                 (identifier)
                 (number_literal))))
+          (whitespace)
+          (whitespace)
           (prefixed_string_literal
             (string_literal))
+          (whitespace)
           (prefixed_string_literal
             (string_literal))
+          (whitespace)
           (prefixed_string_literal
             (string_literal)))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1267,108 +1773,168 @@ end subroutine foo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (block_if_statement
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (number_literal)))
+          (whitespace)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))
+            (whitespace)
+            (whitespace)
             (math_expression
               (identifier)
               (identifier)))
           (end_of_statement)
+          (whitespace)
           (print_statement
+            (whitespace)
             (format_identifier)
+            (whitespace)
             (output_item_list
               (identifier)))
           (end_of_statement))
+        (whitespace)
         (end_if_statement)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -1376,6 +1942,8 @@ end subroutine foo
           (extent_specifier
             (number_literal)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (concatenation_expression
         (identifier)
         (concatenation_expression
@@ -1383,14 +1951,19 @@ end subroutine foo
             (string_literal))
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1410,43 +1983,71 @@ end subroutine test
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
       parameters: (parameters
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (conditional_expression
         condition: (call_expression
           (identifier)
           (argument_list
             (identifier)))
+        (whitespace)
+        (whitespace)
         consequence: (identifier)
+        (whitespace)
+        (whitespace)
         alternative: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       subroutine: (identifier)
       (argument_list
         (conditional_expression
           condition: (relational_expression
             left: (identifier)
+            (whitespace)
+            (whitespace)
             right: (number_literal))
+          (whitespace)
+          (whitespace)
           consequence: (identifier)
+          (whitespace)
+          (whitespace)
           alternative: (nil_literal))))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1469,10 +2070,14 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1480,36 +2085,53 @@ end program test
             (array_literal
               (number_literal)
               (number_literal))))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (multiple_subscript
             (array_literal
               (number_literal)
               (number_literal)))
+          (whitespace)
           (number_literal))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
           (multiple_subscript
             (identifier))
+          (whitespace)
           (extent_specifier)
+          (whitespace)
           (multiple_subscript
             (identifier)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1523,10 +2145,14 @@ end program test
             (array_literal
               (number_literal)
               (number_literal))))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1538,10 +2164,14 @@ end program test
               (number_literal)
               (number_literal))
             (number_literal)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1552,9 +2182,12 @@ end program test
             (array_literal
               (number_literal)
               (number_literal))))))
+    (whitespace)
     (end_of_statement)
     (comment)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1572,22 +2205,31 @@ end
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
@@ -1614,50 +2256,73 @@ end
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))
+          (whitespace)
           (keyword_argument
             (identifier)
             (identifier))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
+          (whitespace)
           (prefixed_string_literal
             (identifier)
-            (string_literal)))))
+            (string_literal))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (number_literal)
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (identifier)
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (prefixed_string_literal
         (number_literal)
         (string_literal)))
diff --git a/test/corpus/line_continuations.txt b/test/corpus/line_continuations.txt
index ba12587..32739bf 100644
--- a/test/corpus/line_continuations.txt
+++ b/test/corpus/line_continuations.txt
@@ -13,23 +13,34 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
+      (whitespace)
       (comment)
+      (whitespace)
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -53,23 +64,36 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
+      (whitespace)
       (comment)
+      (whitespace)
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (keyword_argument
         (identifier)
-        (identifier)))
+        (identifier))
+      (whitespace)
+      (whitespace))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -86,15 +110,25 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
+      (whitespace)
       (comment)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -116,28 +150,44 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (function
         (function_statement
+          (whitespace)
           (name)
           (parameters
+            (whitespace)
+            (whitespace)
             (identifier))
+          (whitespace)
+          (whitespace)
           (comment)
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -156,19 +206,24 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier
         (statement_label_reference)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -191,33 +246,52 @@ end program ! comment
   (comment)
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal
         (identifier)))
+    (whitespace)
     (end_of_statement)
     (comment)
     (internal_procedures
       (contains_statement)
+      (whitespace)
       (end_of_statement)
       (comment)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
+          (whitespace)
           (end_of_statement))
         (comment)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
+          (whitespace)
           (end_of_statement))))
     (comment)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (end_of_statement)))
   (comment)
   (comment))
@@ -243,44 +317,61 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (concatenation_expression
           (prefixed_string_literal
             (string_literal))
+          (whitespace)
+          (whitespace)
+          (whitespace)
           (prefixed_string_literal
             (string_literal)))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))
+        (whitespace)
+        (whitespace)
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -300,27 +391,35 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (hollerith_constant)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (hollerith_constant)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (hollerith_constant)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -338,21 +437,35 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         (array_literal
+          (whitespace)
           (number_literal)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (ERROR
-            (number_literal)))))
+            (whitespace)
+            (whitespace)
+            (number_literal))
+          (whitespace))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
diff --git a/test/corpus/preprocessor.txt b/test/corpus/preprocessor.txt
index ea589be..1795dcd 100644
--- a/test/corpus/preprocessor.txt
+++ b/test/corpus/preprocessor.txt
@@ -11,16 +11,21 @@ Include directives
 
 (translation_unit
   (preproc_include
+    (whitespace)
     path: (string_literal))
   (preproc_include
+    (whitespace)
     path: (system_lib_string))
   (preproc_include
+    (whitespace)
     path: (identifier))
   (preproc_include
+    (whitespace)
     path: (call_expression
       function: (identifier)
       arguments: (argument_list
         (identifier)
+        (whitespace)
         (identifier)))))
 
 ================================================================================
@@ -37,16 +42,24 @@ Object-like macro definitions
 
 (translation_unit
   (preproc_def
+    (whitespace)
     name: (identifier))
   (preproc_def
+    (whitespace)
     name: (identifier)
+    (whitespace)
     value: (preproc_arg))
   (preproc_def
+    (whitespace)
     name: (identifier)
+    (whitespace)
     value: (preproc_arg))
   (preproc_def
-    name: (identifier))
+    (whitespace)
+    name: (identifier)
+    (whitespace))
   (preproc_def
+    (whitespace)
     name: (identifier)))
 
 ================================================================================
@@ -63,29 +76,42 @@ Function-like macro definitions
 
 (translation_unit
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params)
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier))
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier)
+      (whitespace)
       (identifier))
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params)
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier)
-      (identifier))
+      (whitespace)
+      (identifier)
+      (whitespace))
+    (whitespace)
     value: (preproc_arg)))
 
 ================================================================================
@@ -100,10 +126,13 @@ Multiline definitions
 
 (translation_unit
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier)
+      (whitespace)
       (identifier))
+    (whitespace)
     value: (preproc_arg)))
 
 ================================================================================
@@ -135,50 +164,73 @@ end subroutine foo4
 
 (translation_unit
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement))))
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     content: (preproc_def
+      (whitespace)
       name: (identifier)
+      (whitespace)
       value: (preproc_arg))
     alternative: (preproc_elif
+      (whitespace)
       condition: (preproc_defined
+        (whitespace)
         (identifier))
       alternative: (preproc_else
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement)))
         content: (preproc_def
+          (whitespace)
           name: (identifier)
+          (whitespace)
           value: (preproc_arg))))
+    (whitespace)
     (multiline_preproc_comment))
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (inline_preproc_comment)))
 
 ================================================================================
@@ -208,47 +260,66 @@ end subroutine foo5
 
 (translation_unit
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elifdef
+      (whitespace)
       name: (identifier)
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))))
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elifdef
+      (whitespace)
       name: (identifier)
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       alternative: (preproc_else
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement)))))))
 
@@ -279,49 +350,69 @@ end subroutine e
 
 (translation_unit
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elif
+      (whitespace)
       condition: (preproc_defined
         (identifier))
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))))
   (preproc_if
+    (whitespace)
     condition: (preproc_defined
+      (whitespace)
       (identifier))
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elifdef
+      (whitespace)
       name: (identifier)
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       alternative: (preproc_else
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement)))))))
 
@@ -343,27 +434,37 @@ General if blocks
 
 (translation_unit
   (preproc_if
+    (whitespace)
     condition: (binary_expression
       left: (preproc_defined
         (identifier))
+      (whitespace)
+      (whitespace)
       right: (preproc_defined
         (identifier)))
     content: (preproc_def
+      (whitespace)
       name: (identifier)
+      (whitespace)
       value: (preproc_arg))
     alternative: (preproc_elif
+      (whitespace)
       condition: (preproc_defined
         (identifier))
       content: (preproc_def
+        (whitespace)
         name: (identifier))
       alternative: (preproc_elif
+        (whitespace)
         condition: (unary_expression
           argument: (preproc_defined
             (identifier)))
         content: (preproc_def
+          (whitespace)
           name: (identifier))
         alternative: (preproc_else
           content: (preproc_include
+            (whitespace)
             path: (system_lib_string)))))))
 
 ================================================================================
@@ -378,10 +479,12 @@ Unary not
 
 (translation_unit
   (preproc_if
+    (whitespace)
     condition: (unary_expression
       argument: (preproc_defined
         (identifier)))
     content: (preproc_def
+      (whitespace)
       name: (identifier))))
 
 ================================================================================
@@ -395,6 +498,7 @@ Unknown preprocessor directives
 (translation_unit
   (preproc_call
     directive: (preproc_directive)
+    (whitespace)
     argument: (preproc_arg)))
 
 ============================================
@@ -423,50 +527,68 @@ end program test
 (translation_unit
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (preproc_call
       (preproc_directive)
+      (whitespace)
       (preproc_arg))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
       (preproc_call
         (preproc_directive)
+        (whitespace)
         (preproc_arg))
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
         (preproc_call
           (preproc_directive)
+          (whitespace)
           (preproc_arg))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (preproc_call
           (preproc_directive)
+          (whitespace)
           (preproc_arg))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (preproc_call
         (preproc_directive)
+        (whitespace)
         (preproc_arg)))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -487,24 +609,36 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (preproc_if
+      (whitespace)
       condition: (binary_expression
         left: (identifier)
+        (whitespace)
+        (whitespace)
         right: (number_literal))
+      (whitespace)
       content: (use_statement
+        (whitespace)
         (module_name
           (name)))
       content: (end_of_statement))
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -530,35 +664,54 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
       (preproc_include
+        (whitespace)
         (string_literal))
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
         (identifier))
       (end_of_statement)
       (preproc_if
+        (whitespace)
         (identifier)
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (identifier)))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
         (preproc_if
+          (whitespace)
           (identifier)
+          (whitespace)
           (procedure_statement
             (procedure_kind)
+            (whitespace)
+            (whitespace)
             (method_name
               (name)))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -587,35 +740,54 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (preproc_ifdef
+        (whitespace)
         name: (identifier)
+        (whitespace)
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
+          (whitespace)
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement))))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -646,48 +818,78 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           type: (intrinsic_type)
+          (whitespace)
+          (whitespace)
           declarator: (identifier))
         (end_of_statement)
         (preproc_ifdef
+          (whitespace)
           name: (identifier)
+          (whitespace)
           content: (variable_declaration
             type: (intrinsic_type)
+            (whitespace)
+            (whitespace)
             declarator: (identifier))
           content: (end_of_statement)
+          (whitespace)
           content: (assignment_statement
             left: (identifier)
+            (whitespace)
+            (whitespace)
             right: (math_expression
               left: (identifier)
+              (whitespace)
+              (whitespace)
               right: (number_literal)))
           content: (end_of_statement))
+        (whitespace)
         (assignment_statement
           left: (identifier)
+          (whitespace)
+          (whitespace)
           right: (math_expression
             left: (identifier)
+            (whitespace)
+            (whitespace)
             right: (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -717,42 +919,66 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           type: (intrinsic_type)
+          (whitespace)
+          (whitespace)
           declarator: (identifier))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           left: (identifier)
+          (whitespace)
+          (whitespace)
           right: (number_literal
             kind: (identifier)))
         (end_of_statement)
         (preproc_ifdef
+          (whitespace)
           name: (identifier)
+          (whitespace)
           content: (assignment_statement
             left: (identifier)
+            (whitespace)
+            (whitespace)
             right: (number_literal
               kind: (identifier)))
           content: (end_of_statement))
+        (whitespace)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -788,67 +1014,105 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (select_case_statement
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
       (preproc_ifdef
+        (whitespace)
         (identifier)
+        (whitespace)
         (case_statement
+          (whitespace)
           (case_value_range_list
             (prefixed_string_literal
               (string_literal)))
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal))
           (end_of_statement)))
       (preproc_if
+        (whitespace)
         (binary_expression
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal))
+        (whitespace)
         (case_statement
+          (whitespace)
           (case_value_range_list
             (prefixed_string_literal
               (string_literal)))
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal))
           (end_of_statement)))
+      (whitespace)
       (case_statement
+        (whitespace)
         (end_of_statement)
         (preproc_ifdef
+          (whitespace)
           (identifier)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal))
           (end_of_statement)))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -869,25 +1133,38 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (name)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
       (preproc_ifdef
+        (whitespace)
         (identifier)
+        (whitespace)
         (procedure_statement
-          (procedure_kind)
+          (procedure_kind
+            (whitespace))
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -917,64 +1194,96 @@ Preprocessor in specification part
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
     (preproc_ifdef
+      (whitespace)
       (identifier)
       (preproc_ifdef
+        (whitespace)
         (identifier)
         (preproc_ifdef
+          (whitespace)
           (identifier)
+          (whitespace)
           (variable_declaration
             (intrinsic_type
               (kind
                 (keyword_argument
                   (identifier)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (identifier))
           (end_of_statement)
+          (whitespace)
           (variable_declaration
             (intrinsic_type
               (kind
                 (keyword_argument
                   (identifier)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (identifier))
           (end_of_statement)
+          (whitespace)
           (variable_declaration
             (intrinsic_type
               (kind
                 (keyword_argument
                   (identifier)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (init_declarator
               (identifier)
+              (whitespace)
+              (whitespace)
               (unary_expression
                 (number_literal))))
           (end_of_statement)
           (preproc_else
+            (whitespace)
             (variable_declaration
               (intrinsic_type)
+              (whitespace)
+              (whitespace)
               (identifier))
             (end_of_statement)
+            (whitespace)
             (variable_declaration
               (intrinsic_type)
+              (whitespace)
+              (whitespace)
               (identifier))
             (end_of_statement)
+            (whitespace)
             (variable_declaration
               (intrinsic_type)
+              (whitespace)
+              (whitespace)
               (init_declarator
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (unary_expression
                   (number_literal))))
             (end_of_statement)))
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -982,8 +1291,11 @@ Preprocessor in specification part
               (identifier)
               (identifier))))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -991,7 +1303,10 @@ Preprocessor in specification part
               (identifier)
               (identifier))))
         (end_of_statement)))
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1022,28 +1337,42 @@ Baz */
 (translation_unit
   (multiline_preproc_comment)
   (preproc_ifdef
+    (whitespace)
     (identifier))
+  (whitespace)
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (multiline_preproc_comment)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
+    (whitespace)
     (multiline_preproc_comment)
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (multiline_preproc_comment)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (end_program_statement
       (end_of_statement)))
   (multiline_preproc_comment)
   (preproc_ifdef
+    (whitespace)
     (identifier)))
diff --git a/test/corpus/regressions.txt b/test/corpus/regressions.txt
index ac8d966..3bc1032 100644
--- a/test/corpus/regressions.txt
+++ b/test/corpus/regressions.txt
@@ -23,60 +23,92 @@ end program example_padl
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (assignment)
-        (defined_io_procedure)))
+        (whitespace)
+        (defined_io_procedure
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
     (comment)
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
           (argument_list
             (identifier)
+            (whitespace)
             (number_literal)
+            (whitespace)
             (prefixed_string_literal
               (string_literal))))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
           (identifier)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
     (comment)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -99,29 +131,44 @@ end program foo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (if_statement
       (block_if_statement
         (block_label_start_expression)
+        (whitespace)
+        (whitespace)
         (parenthesized_expression
           (boolean_literal))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (subroutine_call
+          (whitespace)
           (identifier)
           (argument_list))
         (end_of_statement)
+        (whitespace)
         (else_clause
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (subroutine_call
+            (whitespace)
             (identifier)
             (argument_list))
           (end_of_statement))
+        (whitespace)
         (end_if_statement
+          (whitespace)
           (block_label))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -143,20 +190,32 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (if_statement
       (block_if_statement
+        (whitespace)
         (parenthesized_expression
           (boolean_literal))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
+          (whitespace)
+          (whitespace)
           (parenthesized_expression
             (boolean_literal))
+          (whitespace)
           (end_of_statement))
-        (end_if_statement)))
+        (whitespace)
+        (end_if_statement
+          (whitespace))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -173,17 +232,26 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -200,21 +268,28 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       left: (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (number_literal)))
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -242,21 +317,29 @@ Multiple array assignments
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (comment)
+  (whitespace)
   (comment)
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
@@ -264,75 +347,112 @@ Multiple array assignments
             (number_literal)
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
diff --git a/test/corpus/statements.txt b/test/corpus/statements.txt
index e4541f7..cb9d55b 100644
--- a/test/corpus/statements.txt
+++ b/test/corpus/statements.txt
@@ -34,74 +34,117 @@ end subroutine foo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (include_statement
+      (whitespace)
       (filename))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (include_statement
+      (whitespace)
       (filename))
     (end_of_statement)
+    (whitespace)
     (interface
       (interface_statement
         (end_of_statement))
+      (whitespace)
       (include_statement
+        (whitespace)
         (filename))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (include_statement
+      (whitespace)
       (filename))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (include_statement
+        (whitespace)
         (filename))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
+        (whitespace)
         (include_statement
+          (whitespace)
           (filename))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_program_statement
+      (whitespace)
       (end_of_statement)))
   (comment)
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (include_statement
+      (whitespace)
       (filename))
     (end_of_statement)
+    (whitespace)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -127,65 +170,109 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (use_alias
           (local_name)
+          (whitespace)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
       (module_name
         (name))
+      (whitespace)
       (use_alias
         (local_name)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
-      (included_items))
+      (included_items
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
+      (whitespace)
       (use_alias
         (local_name)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -204,48 +291,69 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (intrinsic_type)
       (implicit_range
         (implicit_range_letter)
+        (whitespace)
+        (whitespace)
         (implicit_range_letter))
+      (whitespace)
       (intrinsic_type
         (kind
           (number_literal)))
       (implicit_range
         (implicit_range_letter)
         (implicit_range_letter))
+      (whitespace)
       (intrinsic_type
         (kind
           (number_literal)))
       (implicit_range
         (implicit_range_letter)
+        (whitespace)
+        (whitespace)
         (implicit_range_letter))
+      (whitespace)
       (implicit_range
         (implicit_range_letter))
+      (whitespace)
       (implicit_range
         (implicit_range_letter)
         (implicit_range_letter)))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
-      (none))
+      (whitespace)
+      (none)
+      (whitespace)
+      (whitespace))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (derived_type
         (type_name))
       (implicit_range
         (implicit_range_letter))
+      (whitespace)
       (derived_type
         (type_name))
       (implicit_range
         (implicit_range_letter)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -262,17 +370,26 @@ END MODULE
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (save_statement)
     (end_of_statement)
+    (whitespace)
     (save_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -289,19 +406,28 @@ END MODULE
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (private_statement)
     (end_of_statement)
+    (whitespace)
     (private_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (operator
         (operator_name))
+      (whitespace)
       (operator
         (operator_name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -318,19 +444,28 @@ END MODULE
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (public_statement)
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (operator
         (operator_name))
+      (whitespace)
       (operator
         (operator_name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -359,32 +494,51 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (identifier)
+        (whitespace)
+        (whitespace)
         right: (number_literal))
+      (whitespace)
       declarator: (init_declarator
         left: (identifier)
+        (whitespace)
+        (whitespace)
         right: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (assumed_size))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -393,10 +547,12 @@ END PROGRAM
             (math_expression
               left: (identifier)
               right: (number_literal)))))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (identifier)))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -404,108 +560,152 @@ END PROGRAM
             (number_literal)
             (assumed_size)))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (number_literal))))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (pointer_init_declarator
         left: (identifier)
+        (whitespace)
+        (whitespace)
         right: (identifier)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier
         (argument_list
           (extent_specifier)))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (assumed_shape))))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (assumed_size))))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (assumed_size)
           (identifier)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (assumed_size)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (character_length))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (character_length))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (number_literal))
         (character_length)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
       declarator: (init_declarator
         left: (identifier)
         right: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (identifier))))
+      (whitespace)
       attribute: (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           name: (identifier)
           value: (prefixed_string_literal
             (string_literal))))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier
         (argument_list
           (call_expression
             (identifier)
             (argument_list
               (identifier)))))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -527,25 +727,36 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (intrinsic_type))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (intrinsic_type)
         (kind
           (identifier)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (intrinsic_type)
@@ -554,29 +765,44 @@ END PROGRAM
             (identifier)
             (argument_list
               (number_literal)))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name)
         (kind
           (number_literal)
+          (whitespace)
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (unlimited_polymorphic))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -608,6 +834,7 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (internal_procedures
@@ -615,63 +842,94 @@ end module foo
       (end_of_statement)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (derived_type
             (intrinsic_type))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (derived_type
             (intrinsic_type)
             (kind
               (identifier)))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (unlimited_polymorphic))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (derived_type
             (intrinsic_type)
@@ -680,13 +938,20 @@ end module foo
                 (identifier)
                 (argument_list
                   (number_literal)))))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -709,70 +974,109 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_modification
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_modification
       (type_qualifier)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (extent_specifier)
+          (whitespace)
           (extent_specifier)))
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_modification
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (parameter_statement
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal))
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal))
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
             (math_expression
               (number_literal)
+              (whitespace)
+              (whitespace)
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (equivalence_statement
+      (whitespace)
       (equivalence_set
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (equivalence_set
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (save_statement
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (common_block)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (bind_statement
       (language_binding
         (identifier))
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -812,62 +1116,93 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (do_loop
       (do_statement
+        (whitespace)
         (loop_control_expression
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
+          (whitespace)
           (number_literal)))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (identifier)
+        (whitespace)
+        (whitespace)
         (math_expression
           (number_literal)
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (open_statement
         (unit_identifier
           (identifier))
+        (whitespace)
         (keyword_argument
           (identifier)
           (prefixed_string_literal
             (string_literal))))
       (end_of_statement)
+      (whitespace)
       (subroutine_call
+        (whitespace)
         (identifier)
         (argument_list
           (identifier)
+          (whitespace)
           (keyword_argument
             (identifier)
             (boolean_literal))))
       (end_of_statement)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (do_loop
       (do_statement
+        (whitespace)
         (loop_control_expression
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (identifier)))
+          (whitespace)
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (keyword_statement)
       (end_of_statement)
+      (whitespace)
       (keyword_statement
+        (whitespace)
         (statement_label_reference))
       (end_of_statement)
+      (whitespace)
       (end_do_loop_statement))
     (end_of_statement)
+    (whitespace)
     (do_loop
       (block_label_start_expression)
+      (whitespace)
       (do_statement
+        (whitespace)
         (loop_control_expression
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (call_expression
             (identifier)
@@ -879,53 +1214,87 @@ END PROGRAM
                     (number_literal)
                     (identifier))))))))
       (end_of_statement)
+      (whitespace)
       (do_loop
         (do_statement
+          (whitespace)
           (loop_control_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)
+            (whitespace)
             (number_literal)
+            (whitespace)
             (unary_expression
               (number_literal))))
         (end_of_statement)
+        (whitespace)
         (keyword_statement
+          (whitespace)
           (identifier))
         (end_of_statement)
-        (end_do_loop_statement))
+        (whitespace)
+        (end_do_loop_statement
+          (whitespace)))
       (end_of_statement)
+      (whitespace)
       (end_do_loop_statement
+        (whitespace)
+        (whitespace)
         (block_label)))
     (end_of_statement)
+    (whitespace)
     (do_loop
       (do_statement
+        (whitespace)
         (while_statement
+          (whitespace)
           (parenthesized_expression
             (identifier))))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal))
       (end_of_statement)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (do_loop
       (do_statement
+        (whitespace)
         (loop_control_expression
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
+          (whitespace)
           (number_literal)))
       (end_of_statement)
+      (whitespace)
       (if_statement
         (inline_if_statement
+          (whitespace)
           (parenthesized_expression
             (identifier))
+          (whitespace)
           (keyword_statement
+            (whitespace)
+            (whitespace)
             (statement_label_reference))))
       (end_of_statement)
       (statement_label)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -949,92 +1318,140 @@ END PROGRAM TEST
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
       attribute: (type_qualifier
         (argument_list
           (identifier)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (number_literal))
     (end_of_statement)
+    (whitespace)
     (do_loop
       (do_statement
+        (whitespace)
         (concurrent_statement
           (concurrent_header
+            (whitespace)
             (concurrent_control
               (identifier)
+              (whitespace)
+              (whitespace)
               initial: (number_literal)
               final: (identifier))
+            (whitespace)
             (concurrent_mask
               (relational_expression
                 left: (call_expression
                   (identifier)
                   (argument_list
                     (identifier)))
+                (whitespace)
                 right: (number_literal))))
+          (whitespace)
           (concurrent_locality
+            (whitespace)
             (identifier))
+          (whitespace)
           (concurrent_locality
+            (whitespace)
             (identifier)
+            (whitespace)
             (identifier))
+          (whitespace)
           (concurrent_locality
             (binary_op)
             (identifier)
+            (whitespace)
             (identifier))
+          (whitespace)
           (concurrent_locality
             (binary_op)
             (identifier))))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         left: (identifier)
+        (whitespace)
+        (whitespace)
         right: (call_expression
           (identifier)
+          (whitespace)
           (argument_list
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier))))))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         left: (call_expression
           (identifier)
           (argument_list
             (identifier)))
+        (whitespace)
+        (whitespace)
         right: (math_expression
           left: (call_expression
             (identifier)
             (argument_list
               (identifier)))
+          (whitespace)
+          (whitespace)
           right: (identifier)))
       (end_of_statement)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1058,53 +1475,86 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (do_label_statement
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (do_label_statement
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)
+          (whitespace)
           (identifier)))
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (do_label_statement
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_do_label_statement
-      (statement_label))
+      (statement_label)
+      (whitespace)
+      (whitespace))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1122,24 +1572,36 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (keyword_statement
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (keyword_statement
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1178,18 +1640,25 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (if_statement
       (inline_if_statement
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
             (number_literal)))
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (inline_if_statement
         (parenthesized_expression
@@ -1204,8 +1673,10 @@ END PROGRAM
           (identifier)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (block_if_statement
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (call_expression
@@ -1214,17 +1685,26 @@ END PROGRAM
                 (extent_specifier
                   (number_literal)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (prefixed_string_literal
                   (string_literal))))))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (call_expression
@@ -1233,6 +1713,8 @@ END PROGRAM
                   (extent_specifier
                     (number_literal)
                     (number_literal))))
+              (whitespace)
+              (whitespace)
               (call_expression
                 (identifier)
                 (argument_list
@@ -1240,12 +1722,19 @@ END PROGRAM
                     (identifier)
                     (argument_list
                       (number_literal)))))))
+          (whitespace)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal))
           (end_of_statement))
+        (whitespace)
         (elseif_clause
+          (whitespace)
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (call_expression
@@ -1254,6 +1743,8 @@ END PROGRAM
                   (extent_specifier
                     (number_literal)
                     (number_literal))))
+              (whitespace)
+              (whitespace)
               (call_expression
                 (identifier)
                 (argument_list
@@ -1261,40 +1752,67 @@ END PROGRAM
                     (identifier)
                     (argument_list
                       (number_literal)))))))
+          (whitespace)
           (end_of_statement))
+        (whitespace)
         (else_clause
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal))
           (end_of_statement))
+        (whitespace)
         (end_if_statement)))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (block_if_statement
         (block_label_start_expression)
+        (whitespace)
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (number_literal)))
+          (whitespace)
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal))
           (end_of_statement)
+          (whitespace)
           (if_statement
             (block_if_statement
+              (whitespace)
               (parenthesized_expression
                 (call_expression
                   (identifier)
@@ -1302,30 +1820,49 @@ END PROGRAM
                     (extent_specifier
                       (number_literal)
                       (number_literal)))))
+              (whitespace)
               (end_of_statement)
+              (whitespace)
               (assignment_statement
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (number_literal))
               (end_of_statement)
+              (whitespace)
               (else_clause
                 (end_of_statement)
+                (whitespace)
                 (assignment_statement
                   (identifier)
+                  (whitespace)
+                  (whitespace)
                   (number_literal))
                 (end_of_statement))
-              (end_if_statement)))
+              (whitespace)
+              (end_if_statement
+                (whitespace))))
           (end_of_statement))
+        (whitespace)
         (else_clause
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal))
           (end_of_statement))
+        (whitespace)
         (end_if_statement
+          (whitespace)
+          (whitespace)
           (block_label))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1360,6 +1897,7 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (where_statement
@@ -1367,11 +1905,18 @@ end program
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))))
     (end_of_statement)
     (where_statement
@@ -1379,36 +1924,59 @@ end program
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
         (elsewhere_clause
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (number_literal)))
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (math_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (number_literal)))
           (end_of_statement))
         (elsewhere_clause
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (boolean_literal))
           (end_of_statement))
         (end_where_statement)))
@@ -1416,41 +1984,64 @@ end program
     (where_statement
       (block_where_statement
         (block_label_start_expression)
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
         (elsewhere_clause
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (number_literal)))
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (math_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (number_literal)))
           (end_of_statement))
         (elsewhere_clause
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (boolean_literal))
           (end_of_statement))
         (end_where_statement
+          (whitespace)
           (block_label))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1480,37 +2071,54 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (forall_statement
       (inline_forall_statement
         (triplet_spec
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (identifier))
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (identifier))
+        (whitespace)
         (relational_expression
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
+          (whitespace)
           (number_literal))
+        (whitespace)
         (assignment_statement
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
+          (whitespace)
           (math_expression
             (number_literal)
+            (whitespace)
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier)
+                (whitespace)
                 (identifier)))))))
     (end_of_statement)
     (forall_statement
@@ -1519,6 +2127,7 @@ END PROGRAM
           (identifier)
           (number_literal)
           (number_literal))
+        (whitespace)
         (pointer_association_statement
           (derived_type_member_expression
             (call_expression
@@ -1526,6 +2135,8 @@ END PROGRAM
               (argument_list
                 (identifier)))
             (type_member))
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -1541,15 +2152,22 @@ END PROGRAM
     (end_of_statement)
     (forall_statement
       (block_forall_statement
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (identifier))
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (where_statement
           (inline_where_statement
             (parenthesized_expression
@@ -1558,52 +2176,78 @@ END PROGRAM
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (identifier)))
+                (whitespace)
+                (whitespace)
                 (number_literal)))
+            (whitespace)
             (assignment_statement
               (call_expression
                 (identifier)
                 (argument_list
                   (identifier)
+                  (whitespace)
                   (identifier)))
+              (whitespace)
+              (whitespace)
               (math_expression
                 (number_literal)
                 (call_expression
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (identifier)))))))
         (end_of_statement)
-        (end_forall_statement)))
+        (end_forall_statement
+          (whitespace))))
     (end_of_statement)
     (forall_statement
       (block_forall_statement
         (triplet_spec
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (relational_expression
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
+          (whitespace)
           (math_expression
             (math_expression
               (math_expression
@@ -1611,46 +2255,71 @@ END PROGRAM
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (math_expression
                       (identifier)
+                      (whitespace)
+                      (whitespace)
                       (number_literal))))
+                (whitespace)
+                (whitespace)
                 (call_expression
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (math_expression
                       (identifier)
+                      (whitespace)
+                      (whitespace)
                       (number_literal)))))
+              (whitespace)
+              (whitespace)
               (call_expression
                 (identifier)
                 (argument_list
                   (math_expression
                     (identifier)
+                    (whitespace)
+                    (whitespace)
                     (number_literal))
+                  (whitespace)
                   (identifier))))
+            (whitespace)
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (math_expression
                   (identifier)
+                  (whitespace)
+                  (whitespace)
                   (number_literal))
+                (whitespace)
                 (identifier)))))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier))))
         (end_of_statement)
-        (end_forall_statement)))
+        (end_forall_statement
+          (whitespace))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1688,115 +2357,177 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (select_case_statement
       (block_label_start_expression)
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
+            (whitespace)
             (unary_expression
               (number_literal))))
+        (whitespace)
         (block_label)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (unary_expression
             (number_literal)))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
+        (whitespace)
         (block_label)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
-            (number_literal)))
+            (number_literal)
+            (whitespace)))
+        (whitespace)
         (block_label)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (number_literal))
         (end_of_statement))
+      (whitespace)
       (end_select_statement
+        (whitespace)
+        (whitespace)
         (block_label)))
     (end_of_statement)
+    (whitespace)
     (select_case_statement
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
             (prefixed_string_literal
               (string_literal))
+            (whitespace)
+            (whitespace)
             (prefixed_string_literal
               (string_literal)))
+          (whitespace)
           (extent_specifier
             (prefixed_string_literal
               (string_literal))
+            (whitespace)
+            (whitespace)
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
+          (whitespace)
           (output_item_list
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
             (prefixed_string_literal
               (string_literal))
+            (whitespace)
+            (whitespace)
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
+          (whitespace)
           (output_item_list
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (identifier))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
+          (whitespace)
           (output_item_list
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
+          (whitespace)
           (output_item_list
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (select_case_statement
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1819,34 +2550,47 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (string_literal)
+        (whitespace)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
+        (whitespace)
         (string_literal)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
@@ -1855,6 +2599,7 @@ END PROGRAM
         (string_literal)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
@@ -1867,29 +2612,37 @@ END PROGRAM
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
         (hollerith_constant)
+        (whitespace)
         (hollerith_constant)
+        (whitespace)
         (hollerith_constant)
         (edit_descriptor)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (hollerith_constant)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
         (hollerith_constant)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1912,36 +2665,52 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (read_statement
+      (whitespace)
       (format_identifier)
+      (whitespace)
       (input_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
+      (whitespace)
       (format_identifier
         (statement_label_reference))
+      (whitespace)
       (input_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (format_identifier
         (statement_label_reference))
+      (whitespace)
       (input_item_list
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier
         (number_literal))
@@ -1950,37 +2719,46 @@ END PROGRAM
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (input_item_list
         (call_expression
           (identifier)
           (argument_list
             (extent_specifier)))))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (input_item_list
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1999,34 +2777,48 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier))
     (end_of_statement)
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier
         (identifier))
+      (whitespace)
       (output_item_list
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2051,108 +2843,145 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (assumed_size))))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (format_identifier
         (statement_label_reference))
+      (whitespace)
       (output_item_list
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
           (argument_list
             (extent_specifier)))))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (format_identifier
         (prefixed_string_literal
           (string_literal)))
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (format_identifier)
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (format_identifier
         (identifier))
+      (whitespace)
       (output_item_list
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2178,51 +3007,79 @@ end function test4
 (translation_unit
   (function
     (function_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (import_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (import_statement
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (import_statement)
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (import_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2241,34 +3098,49 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
         (sized_declarator
           (identifier)
           (size
             (number_literal)
+            (whitespace)
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (common_statement
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2286,29 +3158,44 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (namelist_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
         (identifier))
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2330,35 +3217,59 @@ END PROGRAM test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (enum
       (enum_statement
+        (whitespace)
         (language_binding
           (identifier))
         (end_of_statement))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
+        (whitespace)
         declarator: (init_declarator
           left: (identifier)
+          (whitespace)
+          (whitespace)
           right: (number_literal)))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
         declarator: (identifier)
+        (whitespace)
         declarator: (identifier))
-      (end_enum_statement))
+      (whitespace)
+      (end_enum_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (enum
       (enum_statement
+        (whitespace)
         (language_binding
           (identifier))
         (end_of_statement))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
+        (whitespace)
         declarator: (init_declarator
           left: (identifier)
+          (whitespace)
+          (whitespace)
           right: (unary_expression
             argument: (number_literal))))
-      (end_enum_statement))
+      (whitespace)
+      (end_enum_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2390,32 +3301,48 @@ end subroutine print_decorated_numbers
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (derived_type
         (unlimited_polymorphic))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (select_type_statement
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier
             (prefixed_string_literal
               (string_literal)))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type
           (kind
             (call_expression
@@ -2423,15 +3350,21 @@ end subroutine print_decorated_numbers
               (argument_list
                 (number_literal)))))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier
             (prefixed_string_literal
               (string_literal)))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type
           (kind
             (call_expression
@@ -2439,50 +3372,73 @@ end subroutine print_decorated_numbers
               (argument_list
                 (number_literal)))))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier
             (prefixed_string_literal
               (string_literal)))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier
             (prefixed_string_literal
               (string_literal)))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (identifier)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier
             (prefixed_string_literal
               (string_literal)))
+          (whitespace)
           (output_item_list
             (derived_type_member_expression
               (identifier)
               (type_member))))
         (end_of_statement))
+      (whitespace)
       (type_statement
-        (class_default)
+        (class_default
+          (whitespace))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2508,55 +3464,71 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (close_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (close_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (prefixed_string_literal
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (unit_identifier
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (close_statement
       (unit_identifier
         (number_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2584,64 +3556,95 @@ end subroutine assumed_rank
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (assumed_rank))))
     (end_of_statement)
+    (whitespace)
     (select_rank_statement
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (rank_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier)
+          (whitespace)
           (output_item_list
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
+      (whitespace)
       (rank_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier)
+          (whitespace)
           (output_item_list
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
+      (whitespace)
       (rank_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier)
+          (whitespace)
           (output_item_list
             (prefixed_string_literal
               (string_literal))))
         (end_of_statement))
+      (whitespace)
       (rank_statement
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (stop_statement
+          (whitespace)
+          (whitespace)
           (prefixed_string_literal
             (string_literal)))
         (end_of_statement))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2662,38 +3665,59 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (associate_statement
       (association
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (association
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (associate_statement
         (block_label_start_expression)
         (association
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (derived_type_member_expression
               (identifier)
               (type_member))
             (argument_list)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_associate_statement
+          (whitespace)
+          (whitespace)
           (block_label)))
       (end_of_statement)
-      (end_associate_statement))
+      (whitespace)
+      (end_associate_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2724,77 +3748,122 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (operator
           (operator_name))
         (end_of_statement))
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (operator
           (operator_name))
         (end_of_statement))
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (unary_expression
           (user_defined_operator
-            (user_defined_operator_name))
+            (whitespace)
+            (user_defined_operator_name)
+            (whitespace))
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (math_expression
           (identifier)
+          (whitespace)
           (user_defined_operator
             (user_defined_operator_name))
+          (whitespace)
           (identifier))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2830,73 +3899,125 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
+        (whitespace)
         (defined_io_procedure)
+        (whitespace)
         (defined_io_procedure)))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (defined_io_procedure))
     (end_of_statement)
+    (whitespace)
     (private_statement
+      (whitespace)
+      (whitespace)
       (defined_io_procedure))
     (end_of_statement)
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (defined_io_procedure)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (defined_io_procedure)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
+        (whitespace)
         (defined_io_procedure)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (defined_io_procedure))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (identifier))
+            (whitespace)
+            (whitespace)
             (method_name
               (name)))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2930,19 +4051,28 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (data_value
           (number_literal)
+          (whitespace)
           (number_literal)))
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal)
+          (whitespace)
           (number_literal)))
       (data_set
         (identifier)
@@ -2950,39 +4080,62 @@ end program test
           (number_literal)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
-          (null_literal))))
+          (whitespace)
+          (null_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
-          (boolean_literal))))
+          (whitespace)
+          (boolean_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (derived_type_member_expression
           (identifier)
           (type_member))
+        (whitespace)
         (data_value
+          (whitespace)
           (prefixed_string_literal
-            (string_literal)))))
+            (string_literal))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal)
+              (whitespace)
               (prefixed_string_literal
-                (string_literal)))))))
+                (string_literal))))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (implied_do_loop_expression
           (call_expression
@@ -2994,69 +4147,119 @@ end program test
             (identifier)
             (number_literal)
             (identifier)))
+        (whitespace)
         (data_value
           (number_literal)
+          (whitespace)
           (unary_expression
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (call_expression
           (identifier)
           (argument_list
             (extent_specifier)
+            (whitespace)
             (identifier)))
+        (whitespace)
         (data_value
+          (whitespace)
+          (whitespace)
           (number_literal
             (identifier))
+          (whitespace)
           (number_literal
-            (identifier)))))
+            (identifier))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
+          (whitespace)
           (complex_literal
+            (whitespace)
             (number_literal)
-            (number_literal))
+            (whitespace)
+            (number_literal)
+            (whitespace))
+          (whitespace)
           (complex_literal
+            (whitespace)
             (number_literal)
-            (number_literal)))))
+            (whitespace)
+            (number_literal)
+            (whitespace))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
+          (whitespace)
           (number_literal)
+          (whitespace)
+          (whitespace)
           (number_literal)
+          (whitespace)
           (number_literal)
+          (whitespace)
+          (whitespace)
           (identifier)
+          (whitespace)
           (number_literal)
-          (number_literal))))
+          (whitespace)
+          (number_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
         (data_value
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (comment)
+    (whitespace)
     (comment)
+    (whitespace)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (comment)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3087,37 +4290,50 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (number_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (derived_type_member_expression
           (identifier)
           (type_member)))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (parenthesized_expression
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (parenthesized_expression
@@ -3126,27 +4342,36 @@ end program
             (argument_list
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (number_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (parenthesized_expression
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -3164,37 +4389,63 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (inquire_statement
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
+          (whitespace)
           (argument_list
             (extent_specifier
               (number_literal)
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (inquire_statement
+      (whitespace)
       (unit_identifier
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3223,37 +4474,48 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (allocate_statement
       allocation: (sized_allocation
         (identifier)
         (size
           (number_literal)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       type: (intrinsic_type)
       allocation: (identifier))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       type: (identifier)
       allocation: (identifier)
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier)))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
-      type: (intrinsic_type)
+      type: (intrinsic_type
+        (whitespace))
       allocation: (identifier))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       type: (identifier)
       allocation: (sized_allocation
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       allocation: (identifier)
+      (whitespace)
       allocation: (sized_allocation
         (derived_type_member_expression
           (derived_type_member_expression
@@ -3262,11 +4524,14 @@ end program test
           (type_member))
         (size
           (number_literal)
+          (whitespace)
           (number_literal)))
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier)))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       allocation: (sized_allocation
         (derived_type_member_expression
@@ -3277,42 +4542,56 @@ end program test
           (type_member))
         (size
           (identifier)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (identifier))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (derived_type_member_expression
         (identifier)
         (type_member)))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (identifier)
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier))
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier)))
     (end_of_statement)
+    (whitespace)
     (nullify_statement
       (identifier))
     (end_of_statement)
+    (whitespace)
     (nullify_statement
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (nullify_statement
       (derived_type_member_expression
         (identifier)
         (type_member)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3326,12 +4605,17 @@ end
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (program
     (arithmetic_if_statement
+      (whitespace)
       (parenthesized_expression
         (identifier))
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference))
     (end_of_statement)
     (end_program_statement
@@ -3359,65 +4643,105 @@ Statement Functions (Obsolescent)
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
+        (whitespace)
         (identifier)
-        (identifier))
+        (whitespace)
+        (identifier)
+        (whitespace))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (comment)
     (comment)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (whitespace)
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (math_expression
         (call_expression
           (identifier)
           (argument_list
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
-                (identifier)))))
+                (whitespace)
+                (identifier)
+                (whitespace)))
+            (whitespace)))
+        (whitespace)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
-                (identifier)))))))
+                (whitespace)
+                (identifier)
+                (whitespace)))
+            (whitespace)))))
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (parameter_statement
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal))
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (prefixed_string_literal
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3446,59 +4770,87 @@ Entry statement (Obsolescent)
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (sized_declarator
         (identifier)
         (character_length)))
     (end_of_statement)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (entry_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (entry_statement
+      (whitespace)
       (name))
     (end_of_statement)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
       (end_of_statement)))
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (entry_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3518,16 +4870,23 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (coarray_declarator
         (identifier)
         (coarray_size)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (coarray_declarator
         (identifier)
         (coarray_size
@@ -3539,16 +4898,24 @@ end program test
           (extent_specifier
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
       (type_qualifier
         (coarray_size
           (extent_specifier)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (coarray_declarator
           (sized_declarator
@@ -3557,6 +4924,7 @@ end program test
               (identifier)))
           (coarray_size))
         (identifier))
+      (whitespace)
       (init_declarator
         (coarray_declarator
           (sized_declarator
@@ -3567,6 +4935,8 @@ end program test
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3587,23 +4957,30 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (coarray_expression
         (identifier)
         (coarray_index
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (boolean_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (coarray_expression
         (call_expression
@@ -3612,6 +4989,8 @@ end program test
             (extent_specifier)))
         (coarray_index
           (identifier)))
+      (whitespace)
+      (whitespace)
       (math_expression
         (coarray_expression
           (call_expression
@@ -3622,22 +5001,32 @@ end program test
             (identifier)))
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (inline_if_statement
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (assignment_statement
           (coarray_expression
             (identifier)
             (coarray_index
               (number_literal)
+              (whitespace)
               (keyword_argument
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (identifier))))
+          (whitespace)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       (coarray_allocation
         (sized_allocation
@@ -3647,6 +5036,8 @@ end program test
         (coarray_size)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3670,57 +5061,79 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (array_literal
           (number_literal)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
-    (coarray_statement)
+    (whitespace)
+    (coarray_statement
+      (whitespace))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (number_literal)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (call_expression
           (identifier)
           (argument_list
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3743,51 +5156,75 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (coarray_team_statement
+      (whitespace)
       (argument_list
         (identifier))
       (end_of_statement)
+      (whitespace)
       (coarray_statement
+        (whitespace)
         (argument_list
           (identifier)
+          (whitespace)
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (coarray_team_statement
         (block_label_start_expression)
+        (whitespace)
+        (whitespace)
         (argument_list
           (identifier))
         (end_of_statement)
+        (whitespace)
         (print_statement
           (format_identifier)
+          (whitespace)
           (output_item_list
             (call_expression
               (identifier)
               (argument_list))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))))
         (end_of_statement)
+        (whitespace)
         (end_coarray_team_statement
+          (whitespace)
+          (whitespace)
           (block_label)))
       (end_of_statement)
-      (end_coarray_team_statement))
+      (whitespace)
+      (end_coarray_team_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3806,20 +5243,29 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (coarray_critical_statement
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))
+        (whitespace)
+        (whitespace)
         (boolean_literal))
       (end_of_statement)
-      (end_coarray_critical_statement))
+      (whitespace)
+      (end_coarray_critical_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3838,20 +5284,33 @@ end program test;
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3868,16 +5327,25 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3897,22 +5365,34 @@ end subroutine test
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
       parameters: (parameters
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (declared_type
         name: (identifier))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -3921,19 +5401,27 @@ end subroutine test
             (argument_list
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (derived_type
         name: (type_name))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (declared_type
         name: (derived_type_member_expression
           (identifier)
           (type_member)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3947,9 +5435,13 @@ end
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (program
     (assign_statement
+      (whitespace)
       (number_literal)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
@@ -3965,8 +5457,10 @@ end
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (program
     (keyword_statement
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
@@ -3985,15 +5479,22 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (keyword_statement
+      (whitespace)
       (identifier)
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference)
+      (whitespace)
       (statement_label_reference))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -4018,34 +5519,47 @@ end subroutine pointer_name_clash
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
+      (whitespace)
       parameters: (parameters
-        (identifier))
+        (whitespace)
+        (identifier)
+        (whitespace))
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (identifier)))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -4055,51 +5569,85 @@ end subroutine pointer_name_clash
               right: (identifier))
             right: (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (cray_pointer_declaration
+      (whitespace)
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier))
+        (whitespace)
+        target: (identifier)
+        (whitespace))
+      (whitespace)
       (cray_pointer_pair
         pointer: (identifier)
+        (whitespace)
         target: (sized_declarator
           (identifier)
           (size
             (extent_specifier
               (number_literal)
-              (number_literal)))))
+              (number_literal))))
+        (whitespace))
+      (whitespace)
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier))
+        (whitespace)
+        target: (identifier)
+        (whitespace))
+      (whitespace)
+      (whitespace)
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier))
+        (whitespace)
+        target: (identifier)
+        (whitespace))
+      (whitespace)
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier)))
+        (whitespace)
+        target: (identifier)
+        (whitespace)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (number_literal)))
+      (whitespace)
+      (whitespace)
       right: (number_literal))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -4119,13 +5667,18 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (data_declarator
         left: (sized_declarator
           (identifier)
@@ -4135,6 +5688,7 @@ end program
           repeat: (number_literal)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
@@ -4150,16 +5704,20 @@ end program
         right: (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (data_declarator
         left: (identifier)
         right: (data_value
           (complex_literal
             (number_literal)
+            (whitespace)
             (number_literal)))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -4177,22 +5735,34 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (bind_statement
       (language_binding
         (identifier))
+      (whitespace)
+      (whitespace)
       (common_block))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
