From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?I=C3=B1aki=20Amatria=20Barral?= <inaki.amatria@appentra.com>
Date: Thu, 16 Oct 2025 15:00:52 +0200
Subject: Parse whitespaces

---
 grammar.js                         |    7 +-
 src/scanner.c                      |    5 -
 test/corpus/constructs.txt         |  804 ++++++++++++++-
 test/corpus/cudafortran.txt        |   35 +-
 test/corpus/expressions.txt        |  546 +++++++++-
 test/corpus/line_continuations.txt |   74 ++
 test/corpus/preprocessor.txt       |  325 +++++-
 test/corpus/regressions.txt        |  122 ++-
 test/corpus/statements.txt         | 1489 +++++++++++++++++++++++++++-
 9 files changed, 3325 insertions(+), 82 deletions(-)

diff --git a/grammar.js b/grammar.js
index c6ffa3b..01799f2 100644
--- a/grammar.js
+++ b/grammar.js
@@ -73,7 +73,8 @@ module.exports = grammar({
   extras: $ => [
     // This allows escaping newlines everywhere, although this is only valid in
     // preprocessor statements
-    /\s|\\\r?\n/,
+    /[\r\n]|\\\r?\n/,
+    $.whitespace,
     $.comment,
     $.multiline_preproc_comment,
     '&',
@@ -158,6 +159,8 @@ module.exports = grammar({
     preproc_def: $ => seq(
       preprocessor('define'),
       field('name', $.identifier),
+      // TODO: Explain!!!!!
+      optional($.whitespace),
       field('value', optional($.preproc_arg)),
       token(prec(1, /\r?\n/)), // force newline to win over preproc_arg
     ),
@@ -2383,6 +2386,8 @@ module.exports = grammar({
       caseInsensitive('write', false),
     ),
 
+    whitespace: $ => /[ \t\v\f]+/,
+
     comment: $ => token(seq('!', /.*/)),
 
     end_of_statement: $ => choice(';', $._external_end_of_statement),
diff --git a/src/scanner.c b/src/scanner.c
index e5a37ee..20dc52f 100644
--- a/src/scanner.c
+++ b/src/scanner.c
@@ -452,11 +452,6 @@ static bool scan_preproc_unary_operator(TSLexer *lexer) {
 }
 
 static bool scan(Scanner *scanner, TSLexer *lexer, const bool *valid_symbols) {
-    // Consume any leading whitespace except newlines
-    while (iswblank(lexer->lookahead)) {
-        skip(lexer);
-    }
-
     // Close the current statement if we can
     if (valid_symbols[END_OF_STATEMENT]) {
         if (scan_end_of_statement(scanner, lexer)) {
diff --git a/test/corpus/constructs.txt b/test/corpus/constructs.txt
index c2eb077..578a6c8 100644
--- a/test/corpus/constructs.txt
+++ b/test/corpus/constructs.txt
@@ -13,15 +13,20 @@ END PROGRAM TEST
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_program_statement
+      (whitespace)
       (end_of_statement)))
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -77,35 +82,55 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (private_statement)
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (name)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (math_expression
           (call_expression
             (identifier)
@@ -116,98 +141,148 @@ end module
             (argument_list
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (concatenation_expression
           (call_expression
             (identifier)
             (argument_list
               (number_literal)))
           (string_literal))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (concatenation_expression
           (call_expression
             (identifier)
             (argument_list
               (number_literal)))
           (string_literal))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (concatenation_expression
           (call_expression
             (identifier)
             (argument_list
               (number_literal)))
           (string_literal))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (function
         (function_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (number_literal)))
+          (whitespace)
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (function
         (function_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -233,19 +308,26 @@ end interface
   (interface
     (interface_statement
       (end_of_statement))
+    (whitespace)
     (subroutine
       (subroutine_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier)
         (sized_declarator
           (identifier)
@@ -253,37 +335,57 @@ end interface
             (number_literal)
             (number_literal))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (function
       (function_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_function_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -309,20 +411,28 @@ end interface
   (interface
     (interface_statement
       (abstract_specifier)
+      (whitespace)
       (end_of_statement))
+    (whitespace)
     (subroutine
       (subroutine_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier)
         (sized_declarator
           (identifier)
@@ -330,37 +440,57 @@ end interface
             (number_literal)
             (number_literal))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (function
       (function_statement
+        (whitespace)
         (name)
         (parameters
           (identifier)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (implicit_statement
+        (whitespace)
         (none))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_function_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -377,17 +507,25 @@ end interface
 (translation_unit
   (interface
     (interface_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -412,49 +550,78 @@ end interface operator (.not.)
 (translation_unit
   (interface
     (interface_statement
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
     (end_interface_statement
+      (whitespace)
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement)))
   (interface
     (interface_statement
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
     (function
       (function_statement
+        (whitespace)
         (name)
         (parameters
           (identifier))
         (end_of_statement))
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_function_statement
+        (whitespace)
         (end_of_statement)))
     (end_interface_statement
+      (whitespace)
+      (whitespace)
       (operator
+        (whitespace)
         (operator_name))
       (end_of_statement))))
 
@@ -471,14 +638,22 @@ end interface assignment (=)
 (translation_unit
   (interface
     (interface_statement
-      (assignment)
+      (whitespace)
+      (assignment
+        (whitespace))
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
     (end_interface_statement
-      (assignment)
+      (whitespace)
+      (whitespace)
+      (assignment
+        (whitespace))
       (end_of_statement))))
 
 ================================================================================
@@ -492,14 +667,22 @@ interface operator(+) ; module procedure test_plus ; end interface
 (translation_unit
   (interface
     (interface_statement
+      (whitespace)
       (operator
         (operator_name))
+      (whitespace)
       (end_of_statement))
+    (whitespace)
     (procedure_statement
-      (procedure_kind)
+      (procedure_kind
+        (whitespace))
+      (whitespace)
       (method_name
         (name)))
+    (whitespace)
+    (whitespace)
     (end_interface_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -517,24 +700,36 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (operator
           (operator_name))
+        (whitespace)
         (assignment)))
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (assignment))
     (end_of_statement)
+    (whitespace)
     (private_statement
+      (whitespace)
       (operator
         (operator_name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -577,117 +772,176 @@ END SUBROUTINE
   (subroutine
     (subroutine_statement
       (procedure_qualifier)
+      (whitespace)
       (procedure_qualifier)
+      (whitespace)
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (language_binding
         (identifier))
       (end_of_statement))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (string_literal)))
       (end_of_statement))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
       (argument_list
         (string_literal)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (assumed_size)))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (assumed_size)
               (assumed_size)))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (identifier))))
         (end_of_statement)
+        (whitespace)
         (keyword_statement)
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
           (end_of_statement))))
     (end_subroutine_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -728,98 +982,139 @@ end function
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (comment)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list)))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (comment)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (language_binding
         (identifier))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (string_literal)))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
+      (whitespace)
       (function_result
         (identifier))
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (string_literal)))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
+      (whitespace)
       (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (string_literal)))
+      (whitespace)
       (function_result
         (identifier))
       (end_of_statement))
     (end_function_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -853,88 +1148,139 @@ end function test
   (function
     (function_statement
       (procedure_qualifier)
+      (whitespace)
       (procedure_qualifier)
+      (whitespace)
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (function_result
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type
             (kind
               (number_literal)))
+          (whitespace)
           (init_declarator
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -976,161 +1322,262 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (end_type_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (access_specifier)
+        (whitespace)
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (end_of_statement)
+      (whitespace)
       (private_statement)
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
           (kind
             (number_literal)))
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (identifier)
         (identifier)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
           (kind
             (identifier)))
+        (whitespace)
         (type_qualifier)
+        (whitespace)
         (type_qualifier
           (argument_list
             (extent_specifier)
+            (whitespace)
             (extent_specifier)
+            (whitespace)
             (extent_specifier)))
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (procedure
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute))
+        (whitespace)
+        (whitespace)
         (pointer_init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (null_literal)))
       (end_of_statement)
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute
             (identifier))
+          (whitespace)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (identifier))
+            (whitespace)
+            (whitespace)
             (method_name
               (name)))
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (assignment))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (operator
                 (operator_name)))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))
+          (whitespace)
           (binding
             (binding_name
               (identifier))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (abstract_specifier)
+        (whitespace)
+        (whitespace)
         (type_name)
         (derived_type_parameter_list
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement))
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal)))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
+          (whitespace)
           (kind
             (call_expression
               (identifier)
               (argument_list
                 (number_literal)))))
+        (whitespace)
         (type_qualifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type
           (kind
             (identifier)))
+        (whitespace)
+        (whitespace)
         (sized_declarator
           (identifier)
           (size
             (identifier)
+            (whitespace)
             (identifier))))
       (end_of_statement)
+      (whitespace)
       (end_type_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1149,28 +1596,46 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         access: (access_specifier)
+        (whitespace)
         (abstract_specifier)
+        (whitespace)
+        (whitespace)
         name: (type_name)
         (end_of_statement))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         access: (access_specifier)
+        (whitespace)
         base: (base_type_specifier
           (identifier))
+        (whitespace)
+        (whitespace)
         name: (type_name)
         (end_of_statement))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1193,35 +1658,54 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
           (procedure_interface)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (interface
       (interface_statement
         (abstract_specifier)
+        (whitespace)
         (end_of_statement))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1242,28 +1726,45 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (private_statement)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
+          (whitespace)
           (method_name
             (name)))
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1283,35 +1784,57 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (variable_declaration
         (procedure
           (procedure_interface)
+          (whitespace)
           (procedure_attribute))
+        (whitespace)
+        (whitespace)
         (pointer_init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (null_literal))
+        (whitespace)
         (pointer_init_declarator
           (identifier)
+          (whitespace)
+          (whitespace)
           (null_literal
             (identifier))))
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (procedure
           (procedure_interface)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
           (procedure_attribute))
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1338,15 +1861,19 @@ END SUBMODULE ConstructorMethods_child
     (submodule_statement
       (module_name
         (name))
+      (whitespace)
       (name)
       (end_of_statement))
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement))
     (end_submodule_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (submodule
@@ -1355,15 +1882,19 @@ END SUBMODULE ConstructorMethods_child
         (name))
       (module_name
         (name))
+      (whitespace)
       (name)
       (end_of_statement))
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement))
     (end_submodule_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1394,6 +1925,7 @@ END MODULE BoundingBox_Method
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (private_statement)
@@ -1401,51 +1933,79 @@ END MODULE BoundingBox_Method
     (interface
       (interface_statement
         (end_of_statement))
+      (whitespace)
       (subroutine
         (subroutine_statement
           (procedure_qualifier)
+          (whitespace)
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (interface
       (interface_statement
         (end_of_statement))
+      (whitespace)
       (function
         (function_statement
           (procedure_qualifier)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier))
+          (whitespace)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1472,43 +2032,65 @@ end module test
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (interface
       (interface_statement
         (abstract_specifier)
+        (whitespace)
         (end_of_statement))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (procedure
             (procedure_interface))
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (procedure
             (procedure_interface))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (procedure
             (intrinsic_type
@@ -1516,17 +2098,27 @@ end module test
                 (keyword_argument
                   (identifier)
                   (identifier)))))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (subroutine_call
+          (whitespace)
           (identifier)
           (argument_list))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1557,64 +2149,100 @@ end program block_demo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (block_construct
       (end_of_statement)
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
+        (whitespace)
         (init_declarator
           (identifier)
+          (whitespace)
           (number_literal)))
       (end_of_statement)
+      (whitespace)
       (print_statement
         (format_identifier)
+        (whitespace)
         (output_item_list
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (block_construct
         (block_label_start_expression)
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (init_declarator
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (print_statement
           (format_identifier)
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement)
+        (whitespace)
         (end_block_construct_statement
+          (whitespace)
+          (whitespace)
           (block_label)))
       (end_of_statement)
-      (end_block_construct_statement))
+      (whitespace)
+      (end_block_construct_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1634,22 +2262,41 @@ end module enumeration_mod
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (enumeration_type
       (enumeration_type_statement
+        (whitespace)
+        (whitespace)
         (access_specifier)
+        (whitespace)
+        (whitespace)
         (type_name))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
         (identifier))
+      (whitespace)
       (end_enumeration_type_statement
+        (whitespace)
+        (whitespace)
+        (whitespace)
         (name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1710,198 +2357,331 @@ Block Data (Obsolescent)
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
       (name)
       (end_of_statement)))
+  (whitespace)
   (block_data
     (block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (end_block_data_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
diff --git a/test/corpus/cudafortran.txt b/test/corpus/cudafortran.txt
index b351532..2da0d93 100644
--- a/test/corpus/cudafortran.txt
+++ b/test/corpus/cudafortran.txt
@@ -13,22 +13,35 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_modification
       (variable_attributes)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -48,23 +61,33 @@ end function
   (function
     (function_statement
       (procedure_attributes)
+      (whitespace)
       (intrinsic_type
         (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (comment)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list)))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -85,9 +108,12 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
       (cuda_kernel_argument_list
         (number_literal)
@@ -95,7 +121,9 @@ end program
       (argument_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
       (cuda_kernel_argument_list
         (number_literal)
@@ -108,8 +136,11 @@ end program
       (argument_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (identifier)
+      (whitespace)
       (cuda_kernel_argument_list
         (number_literal)
         (identifier)
@@ -117,9 +148,11 @@ end program
         (call_expression
           (identifier)
           (argument_list
-            (identifier))))
+            (identifier)))
+        (whitespace))
       (argument_list
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
diff --git a/test/corpus/expressions.txt b/test/corpus/expressions.txt
index a9771e1..e5f7561 100644
--- a/test/corpus/expressions.txt
+++ b/test/corpus/expressions.txt
@@ -36,130 +36,191 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (number_literal)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (unary_expression
           (number_literal))
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (complex_literal
         (number_literal)
+        (whitespace)
         (unary_expression
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (boolean_literal
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -187,42 +248,61 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (concatenation_expression
         left: (string_literal)
         right: (concatenation_expression
@@ -231,17 +311,22 @@ END PROGRAM
             left: (identifier)
             right: (identifier)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal
         kind: (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (string_literal
         kind: (number_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -258,17 +343,25 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (boolean_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (boolean_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -287,33 +380,46 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         right: (array_literal
           (number_literal)
           (number_literal)
-          (number_literal))))
+          (number_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         right: (array_literal
           (math_expression
             left: (number_literal)
             right: (number_literal))
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -321,37 +427,49 @@ end program
                 (identifier)
                 (argument_list
                   (number_literal)))))
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         right: (array_literal
           (unary_expression
             argument: (number_literal))
           (number_literal)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       subroutine: (identifier)
       (argument_list
         (identifier)
+        (whitespace)
         (array_literal
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
-              (number_literal))))))
+              (number_literal)))
+          (whitespace))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -374,22 +492,28 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (extent_specifier)))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -397,8 +521,10 @@ END PROGRAM
           (extent_specifier
             (number_literal)
             (number_literal))))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -407,16 +533,20 @@ END PROGRAM
             (number_literal)
             (number_literal)
             (number_literal))))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (extent_specifier
             (number_literal))))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -430,14 +560,18 @@ END PROGRAM
               (number_literal)
               (identifier))
             (identifier))))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (identifier)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -445,8 +579,10 @@ END PROGRAM
                 (identifier)
                 (argument_list
                   (identifier)))))))
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -459,9 +595,11 @@ END PROGRAM
                   (identifier)
                   (number_literal))))
             (identifier))))
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -479,26 +617,37 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (pointer_association_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (pointer_association_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (pointer_association_statement
       (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -516,20 +665,28 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (derived_type_member_expression
         (identifier)
         (type_member)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (derived_type_member_expression
@@ -539,9 +696,12 @@ END PROGRAM
           (extent_specifier
             (number_literal)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -565,74 +725,115 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (unary_expression
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (unary_expression
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (math_expression
         (math_expression
           (math_expression
             (identifier)
             (identifier))
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
             (parenthesized_expression
               (unary_expression
                 (number_literal)))))
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (math_expression
         (number_literal)
+        (whitespace)
+        (whitespace)
         (math_expression
           (parenthesized_expression
             (math_expression
               (identifier)
+              (whitespace)
+              (whitespace)
               (identifier)))
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -667,139 +868,244 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (relational_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (parenthesized_expression
         (logical_expression
+          (whitespace)
           (relational_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (logical_expression
         (parenthesized_expression
           (logical_expression
             (parenthesized_expression
               (relational_expression
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (identifier)))
+            (whitespace)
+            (whitespace)
             (parenthesized_expression
               (relational_expression
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (identifier)))))
+        (whitespace)
+        (whitespace)
         (boolean_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (relational_expression
         (number_literal)
         (number_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -821,29 +1127,43 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
           (math_expression
             left: (math_expression
               left: (number_literal)
+              (whitespace)
+              (whitespace)
               right: (identifier))
+            (whitespace)
+            (whitespace)
             right: (math_expression
               left: (identifier)
               right: (identifier))))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (math_expression
         left: (call_expression
           (identifier)
@@ -856,26 +1176,36 @@ END PROGRAM
                     left: (identifier)
                     right: (identifier))
                   (number_literal)))
+              (whitespace)
               right: (number_literal))))
+        (whitespace)
         right: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       subroutine: (identifier)
       (argument_list
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (string_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (derived_type_member_expression
         (identifier)
         (type_member))
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
@@ -886,8 +1216,11 @@ END PROGRAM
                 (number_literal)
                 (identifier)))))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
@@ -907,6 +1240,7 @@ END PROGRAM
               (number_literal))))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -923,15 +1257,20 @@ end program use_type_bound_procedures
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (derived_type_member_expression
         (identifier)
         (type_member))
       (argument_list))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       (derived_type_member_expression
         (derived_type_member_expression
           (call_expression
@@ -943,6 +1282,8 @@ end program use_type_bound_procedures
       (argument_list))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -965,28 +1306,37 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
       (format_identifier
         (string_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal))
+      (whitespace)
       (comment)
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (comment)
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (comment)
+    (whitespace)
     (stop_statement)
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1003,14 +1353,18 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
       (format_identifier)
       (output_item_list
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1035,36 +1389,57 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
         (ERROR
           (number_literal))
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (array_literal
           (ERROR
+            (number_literal)
+            (whitespace)
             (number_literal))
+          (whitespace)
           (identifier)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal)))
+          (whitespace)
           (ERROR
+            (whitespace)
             (implicit_range_letter)
             (implicit_range_letter)
             (implicit_range_letter)
+            (whitespace))
+          (whitespace)
+          (ERROR
             (ERROR
               (number_literal))
             (user_defined_operator_name)
@@ -1072,6 +1447,7 @@ end program
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1097,34 +1473,53 @@ end program array_constructors
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (array_literal
+          (whitespace)
           (implied_do_loop_expression
             (identifier)
+            (whitespace)
             (loop_control_expression
               (identifier)
               (number_literal)
-              (number_literal)))))
+              (number_literal)))
+          (whitespace)))
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
+        (whitespace)
         (array_literal
           (implied_do_loop_expression
             (identifier)
+            (whitespace)
             (intrinsic_type
               (kind
                 (keyword_argument
@@ -1135,15 +1530,22 @@ end program array_constructors
               (number_literal)
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (array_literal
         (implied_do_loop_expression
           (parenthesized_expression
@@ -1153,20 +1555,28 @@ end program array_constructors
                 (argument_list
                   (math_expression
                     (identifier)
+                    (whitespace)
                     (number_literal))))
+              (whitespace)
               (number_literal)))
+          (whitespace)
           (loop_control_expression
             (identifier)
             (number_literal)
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (array_literal
         (intrinsic_type)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
@@ -1180,8 +1590,10 @@ end program array_constructors
               (number_literal)
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
@@ -1192,8 +1604,10 @@ end program array_constructors
               (number_literal)
               (number_literal))))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (array_literal
           (intrinsic_type
@@ -1201,11 +1615,14 @@ end program array_constructors
               (keyword_argument
                 (identifier)
                 (number_literal))))
+          (whitespace)
           (string_literal)
           (string_literal)
           (string_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1240,108 +1657,162 @@ end subroutine foo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (block_if_statement
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
               (number_literal)))
+          (whitespace)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))
+            (whitespace)
+            (whitespace)
             (math_expression
               (identifier)
               (identifier)))
           (end_of_statement)
+          (whitespace)
           (print_statement
+            (whitespace)
             (format_identifier)
+            (whitespace)
             (output_item_list
               (identifier)))
           (end_of_statement))
+        (whitespace)
         (end_if_statement)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
@@ -1349,20 +1820,26 @@ end subroutine foo
           (extent_specifier
             (number_literal)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (concatenation_expression
         (identifier)
         (concatenation_expression
           (string_literal)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)))
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1382,43 +1859,69 @@ end subroutine test
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
       parameters: (parameters
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
+      (whitespace)
       right: (conditional_expression
         condition: (call_expression
           (identifier)
           (argument_list
             (identifier)))
+        (whitespace)
+        (whitespace)
         consequence: (identifier)
+        (whitespace)
         alternative: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (subroutine_call
+      (whitespace)
       subroutine: (identifier)
       (argument_list
         (conditional_expression
           condition: (relational_expression
             left: (identifier)
+            (whitespace)
             right: (number_literal))
+          (whitespace)
+          (whitespace)
           consequence: (identifier)
+          (whitespace)
+          (whitespace)
           alternative: (nil_literal))))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1441,10 +1944,14 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1452,36 +1959,52 @@ end program test
             (array_literal
               (number_literal)
               (number_literal))))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
           (number_literal)
+          (whitespace)
           (multiple_subscript
             (array_literal
               (number_literal)
               (number_literal)))
           (number_literal))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
           (multiple_subscript
             (identifier))
+          (whitespace)
           (extent_specifier)
+          (whitespace)
           (multiple_subscript
             (identifier)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1495,10 +2018,14 @@ end program test
             (array_literal
               (number_literal)
               (number_literal))))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1510,10 +2037,14 @@ end program test
               (number_literal)
               (number_literal))
             (number_literal)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -1524,9 +2055,12 @@ end program test
             (array_literal
               (number_literal)
               (number_literal))))))
+    (whitespace)
     (end_of_statement)
     (comment)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1544,22 +2078,28 @@ end
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (number_literal)
           (number_literal)))
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
diff --git a/test/corpus/line_continuations.txt b/test/corpus/line_continuations.txt
index c086fe8..0abea75 100644
--- a/test/corpus/line_continuations.txt
+++ b/test/corpus/line_continuations.txt
@@ -13,21 +13,27 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
       (format_identifier
         (string_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal))
+      (whitespace)
       (comment)
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -51,21 +57,27 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
       (format_identifier
         (string_literal))
+      (whitespace)
       (comment)
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -82,15 +94,23 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (comment)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -112,28 +132,40 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (function
         (function_statement
+          (whitespace)
           (name)
           (parameters
             (identifier))
+          (whitespace)
           (comment)
           (function_result
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -152,19 +184,23 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier)
       (format_identifier
         (statement_label_reference)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -187,33 +223,50 @@ end program ! comment
   (comment)
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal
         (identifier)))
+    (whitespace)
     (end_of_statement)
     (comment)
     (internal_procedures
       (contains_statement)
+      (whitespace)
       (end_of_statement)
       (comment)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
+          (whitespace)
           (end_of_statement))
         (comment)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
+          (whitespace)
           (end_of_statement))))
     (comment)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (end_of_statement)))
   (comment)
   (comment))
@@ -239,30 +292,37 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
       (format_identifier)
       (output_item_list
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
       (output_item_list
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
       (output_item_list
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
       (output_item_list
         (concatenation_expression
           (string_literal)
+          (whitespace)
           (string_literal))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
       (output_item_list
@@ -270,6 +330,7 @@ end program
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -289,27 +350,32 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
         (hollerith_constant)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
         (hollerith_constant)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
         (hollerith_constant)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -327,15 +393,21 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
+        (whitespace)
         (array_literal
           (number_literal)
           (number_literal)
@@ -343,5 +415,7 @@ end program test
             (number_literal)))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
diff --git a/test/corpus/preprocessor.txt b/test/corpus/preprocessor.txt
index b0b35bd..cd5e60c 100644
--- a/test/corpus/preprocessor.txt
+++ b/test/corpus/preprocessor.txt
@@ -13,14 +13,18 @@ Include directives
   (preproc_include
     path: (string_literal))
   (preproc_include
+    (whitespace)
     path: (system_lib_string))
   (preproc_include
+    (whitespace)
     path: (identifier))
   (preproc_include
+    (whitespace)
     path: (call_expression
       function: (identifier)
       arguments: (argument_list
         (identifier)
+        (whitespace)
         (identifier)))))
 
 ================================================================================
@@ -37,16 +41,24 @@ Object-like macro definitions
 
 (translation_unit
   (preproc_def
+    (whitespace)
     name: (identifier))
   (preproc_def
+    (whitespace)
     name: (identifier)
+    (whitespace)
     value: (preproc_arg))
   (preproc_def
+    (whitespace)
     name: (identifier)
+    (whitespace)
     value: (preproc_arg))
   (preproc_def
-    name: (identifier))
+    (whitespace)
+    name: (identifier)
+    (whitespace))
   (preproc_def
+    (whitespace)
     name: (identifier)))
 
 ================================================================================
@@ -63,29 +75,42 @@ Function-like macro definitions
 
 (translation_unit
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params)
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier))
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier)
+      (whitespace)
       (identifier))
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params)
+    (whitespace)
     value: (preproc_arg))
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier)
-      (identifier))
+      (whitespace)
+      (identifier)
+      (whitespace))
+    (whitespace)
     value: (preproc_arg)))
 
 ================================================================================
@@ -100,10 +125,14 @@ Multiline definitions
 
 (translation_unit
   (preproc_function_def
+    (whitespace)
     name: (identifier)
     parameters: (preproc_params
       (identifier)
+      (whitespace)
       (identifier))
+    (whitespace)
+    (whitespace)
     value: (preproc_arg)))
 
 ================================================================================
@@ -135,50 +164,73 @@ end subroutine foo4
 
 (translation_unit
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement))))
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     content: (preproc_def
+      (whitespace)
       name: (identifier)
+      (whitespace)
       value: (preproc_arg))
     alternative: (preproc_elif
+      (whitespace)
       condition: (preproc_defined
+        (whitespace)
         (identifier))
       alternative: (preproc_else
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement)))
         content: (preproc_def
+          (whitespace)
           name: (identifier)
+          (whitespace)
           value: (preproc_arg))))
+    (whitespace)
     (multiline_preproc_comment))
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
+    (whitespace)
     (inline_preproc_comment)))
 
 ================================================================================
@@ -208,47 +260,66 @@ end subroutine foo5
 
 (translation_unit
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elifdef
+      (whitespace)
       name: (identifier)
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))))
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elifdef
+      (whitespace)
       name: (identifier)
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       alternative: (preproc_else
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement)))))))
 
@@ -279,49 +350,69 @@ end subroutine e
 
 (translation_unit
   (preproc_ifdef
+    (whitespace)
     name: (identifier)
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elif
+      (whitespace)
       condition: (preproc_defined
         (identifier))
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))))
   (preproc_if
+    (whitespace)
     condition: (preproc_defined
+      (whitespace)
       (identifier))
     content: (subroutine
       (subroutine_statement
+        (whitespace)
         name: (name)
         (end_of_statement))
       (end_subroutine_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     alternative: (preproc_elifdef
+      (whitespace)
       name: (identifier)
       content: (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       alternative: (preproc_else
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement)))))))
 
@@ -343,27 +434,35 @@ General if blocks
 
 (translation_unit
   (preproc_if
+    (whitespace)
     condition: (binary_expression
       left: (preproc_defined
         (identifier))
+      (whitespace)
       right: (preproc_defined
         (identifier)))
     content: (preproc_def
+      (whitespace)
       name: (identifier)
+      (whitespace)
       value: (preproc_arg))
     alternative: (preproc_elif
+      (whitespace)
       condition: (preproc_defined
         (identifier))
       content: (preproc_def
+        (whitespace)
         name: (identifier))
       alternative: (preproc_elif
         condition: (unary_expression
           argument: (preproc_defined
             (identifier)))
         content: (preproc_def
+          (whitespace)
           name: (identifier))
         alternative: (preproc_else
           content: (preproc_include
+            (whitespace)
             path: (system_lib_string)))))))
 
 ================================================================================
@@ -382,6 +481,7 @@ Unary not
       argument: (preproc_defined
         (identifier)))
     content: (preproc_def
+      (whitespace)
       name: (identifier))))
 
 ================================================================================
@@ -395,6 +495,7 @@ Unknown preprocessor directives
 (translation_unit
   (preproc_call
     directive: (preproc_directive)
+    (whitespace)
     argument: (preproc_arg)))
 
 ============================================
@@ -423,50 +524,68 @@ end program test
 (translation_unit
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (preproc_call
     (preproc_directive)
+    (whitespace)
     (preproc_arg))
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (preproc_call
       (preproc_directive)
+      (whitespace)
       (preproc_arg))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
       (preproc_call
         (preproc_directive)
+        (whitespace)
         (preproc_arg))
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
         (preproc_call
           (preproc_directive)
+          (whitespace)
           (preproc_arg))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (preproc_call
           (preproc_directive)
+          (whitespace)
           (preproc_arg))
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (preproc_call
         (preproc_directive)
+        (whitespace)
         (preproc_arg)))
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -487,24 +606,35 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (preproc_if
+      (whitespace)
       condition: (binary_expression
         left: (identifier)
+        (whitespace)
         right: (number_literal))
+      (whitespace)
       content: (use_statement
+        (whitespace)
         (module_name
           (name)))
       content: (end_of_statement))
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -530,35 +660,53 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
       (preproc_include
         (string_literal))
+      (whitespace)
       (variable_declaration
         (intrinsic_type)
+        (whitespace)
         (identifier))
       (end_of_statement)
       (preproc_if
+        (whitespace)
         (identifier)
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (identifier)))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
         (preproc_if
+          (whitespace)
           (identifier)
+          (whitespace)
           (procedure_statement
             (procedure_kind)
+            (whitespace)
+            (whitespace)
             (method_name
               (name)))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -587,35 +735,54 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (preproc_ifdef
+        (whitespace)
         name: (identifier)
+        (whitespace)
         content: (subroutine
           (subroutine_statement
+            (whitespace)
             name: (name)
             (end_of_statement))
+          (whitespace)
           (end_subroutine_statement
+            (whitespace)
+            (whitespace)
             (name)
             (end_of_statement))))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -646,48 +813,76 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           type: (intrinsic_type)
+          (whitespace)
+          (whitespace)
           declarator: (identifier))
         (end_of_statement)
         (preproc_ifdef
+          (whitespace)
           name: (identifier)
+          (whitespace)
           content: (variable_declaration
             type: (intrinsic_type)
+            (whitespace)
+            (whitespace)
             declarator: (identifier))
           content: (end_of_statement)
+          (whitespace)
           content: (assignment_statement
             left: (identifier)
+            (whitespace)
+            (whitespace)
             right: (math_expression
               left: (identifier)
+              (whitespace)
               right: (number_literal)))
           content: (end_of_statement))
+        (whitespace)
         (assignment_statement
           left: (identifier)
+          (whitespace)
+          (whitespace)
           right: (math_expression
             left: (identifier)
+            (whitespace)
             right: (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -717,42 +912,64 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           type: (intrinsic_type)
+          (whitespace)
+          (whitespace)
           declarator: (identifier))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           left: (identifier)
+          (whitespace)
           right: (number_literal
             kind: (identifier)))
         (end_of_statement)
         (preproc_ifdef
+          (whitespace)
           name: (identifier)
+          (whitespace)
           content: (assignment_statement
             left: (identifier)
+            (whitespace)
             right: (number_literal
               kind: (identifier)))
           content: (end_of_statement))
+        (whitespace)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           name: (name)
           (end_of_statement))
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -788,64 +1005,97 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (select_case_statement
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
       (preproc_ifdef
+        (whitespace)
         (identifier)
+        (whitespace)
         (case_statement
+          (whitespace)
           (case_value_range_list
             (string_literal))
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
             (number_literal))
           (end_of_statement)))
       (preproc_if
+        (whitespace)
         (binary_expression
           (identifier)
+          (whitespace)
           (number_literal))
+        (whitespace)
         (case_statement
+          (whitespace)
           (case_value_range_list
             (string_literal))
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
             (number_literal))
           (end_of_statement)))
+      (whitespace)
       (case_statement
+        (whitespace)
         (end_of_statement)
         (preproc_ifdef
+          (whitespace)
           (identifier)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
             (number_literal))
           (end_of_statement)))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -866,25 +1116,38 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (name)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
       (preproc_ifdef
+        (whitespace)
         (identifier)
+        (whitespace)
         (procedure_statement
-          (procedure_kind)
+          (procedure_kind
+            (whitespace))
+          (whitespace)
           (method_name
             (name))))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -914,64 +1177,96 @@ Preprocessor in specification part
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
     (preproc_ifdef
+      (whitespace)
       (identifier)
       (preproc_ifdef
+        (whitespace)
         (identifier)
         (preproc_ifdef
+          (whitespace)
           (identifier)
+          (whitespace)
           (variable_declaration
             (intrinsic_type
               (kind
                 (keyword_argument
                   (identifier)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (identifier))
           (end_of_statement)
+          (whitespace)
           (variable_declaration
             (intrinsic_type
               (kind
                 (keyword_argument
                   (identifier)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (identifier))
           (end_of_statement)
+          (whitespace)
           (variable_declaration
             (intrinsic_type
               (kind
                 (keyword_argument
                   (identifier)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (init_declarator
               (identifier)
+              (whitespace)
+              (whitespace)
               (unary_expression
                 (number_literal))))
           (end_of_statement)
           (preproc_else
+            (whitespace)
             (variable_declaration
               (intrinsic_type)
+              (whitespace)
+              (whitespace)
               (identifier))
             (end_of_statement)
+            (whitespace)
             (variable_declaration
               (intrinsic_type)
+              (whitespace)
+              (whitespace)
               (identifier))
             (end_of_statement)
+            (whitespace)
             (variable_declaration
               (intrinsic_type)
+              (whitespace)
+              (whitespace)
               (init_declarator
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (unary_expression
                   (number_literal))))
             (end_of_statement)))
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -979,8 +1274,11 @@ Preprocessor in specification part
               (identifier)
               (identifier))))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -988,7 +1286,10 @@ Preprocessor in specification part
               (identifier)
               (identifier))))
         (end_of_statement)))
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1019,28 +1320,42 @@ Baz */
 (translation_unit
   (multiline_preproc_comment)
   (preproc_ifdef
+    (whitespace)
     (identifier))
+  (whitespace)
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (multiline_preproc_comment)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
+    (whitespace)
     (multiline_preproc_comment)
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (multiline_preproc_comment)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (end_program_statement
       (end_of_statement)))
   (multiline_preproc_comment)
   (preproc_ifdef
+    (whitespace)
     (identifier)))
diff --git a/test/corpus/regressions.txt b/test/corpus/regressions.txt
index 0b7937a..e1012e4 100644
--- a/test/corpus/regressions.txt
+++ b/test/corpus/regressions.txt
@@ -23,38 +23,59 @@ end program example_padl
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (assignment)
-        (defined_io_procedure)))
+        (whitespace)
+        (defined_io_procedure
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (string_literal))
     (end_of_statement)
     (comment)
+    (whitespace)
     (print_statement
       (format_identifier
         (string_literal))
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
@@ -62,10 +83,14 @@ end program example_padl
             (identifier)
             (number_literal)
             (string_literal)))))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
@@ -74,6 +99,8 @@ end program example_padl
     (end_of_statement)
     (comment)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -96,29 +123,44 @@ end program foo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (if_statement
       (block_if_statement
         (block_label_start_expression)
+        (whitespace)
+        (whitespace)
         (parenthesized_expression
           (boolean_literal))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (subroutine_call
+          (whitespace)
           (identifier)
           (argument_list))
         (end_of_statement)
+        (whitespace)
         (else_clause
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (subroutine_call
+            (whitespace)
             (identifier)
             (argument_list))
           (end_of_statement))
+        (whitespace)
         (end_if_statement
+          (whitespace)
           (block_label))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -140,20 +182,30 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (if_statement
       (block_if_statement
+        (whitespace)
         (parenthesized_expression
           (boolean_literal))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
           (parenthesized_expression
             (boolean_literal))
+          (whitespace)
           (end_of_statement))
-        (end_if_statement)))
+        (whitespace)
+        (end_if_statement
+          (whitespace))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -170,17 +222,25 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -197,14 +257,18 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (assignment_statement
       left: (call_expression
         (identifier)
         (argument_list
           (number_literal)
           (number_literal)))
+      (whitespace)
+      (whitespace)
       right: (call_expression
         (identifier)
         (argument_list
@@ -212,6 +276,7 @@ end program
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -239,21 +304,29 @@ Multiple array assignments
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (comment)
+  (whitespace)
   (comment)
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type
         (kind
           (keyword_argument
             (identifier)
             (number_literal))))
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
@@ -261,67 +334,96 @@ Multiple array assignments
             (number_literal)
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (identifier)
+          (whitespace)))
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
diff --git a/test/corpus/statements.txt b/test/corpus/statements.txt
index 41a00f8..b1c0c82 100644
--- a/test/corpus/statements.txt
+++ b/test/corpus/statements.txt
@@ -34,74 +34,108 @@ end subroutine foo
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (include_statement
       (filename))
+    (whitespace)
     (end_of_statement)
     (comment)
+    (whitespace)
     (include_statement
       (filename))
     (end_of_statement)
+    (whitespace)
     (interface
       (interface_statement
         (end_of_statement))
+      (whitespace)
       (include_statement
         (filename))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (include_statement
       (filename))
     (end_of_statement)
     (internal_procedures
       (contains_statement)
       (end_of_statement)
+      (whitespace)
       (include_statement
         (filename))
+      (whitespace)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (end_of_statement))
+        (whitespace)
         (include_statement
           (filename))
         (end_of_statement)
+        (whitespace)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_program_statement
+      (whitespace)
       (end_of_statement)))
   (comment)
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (include_statement
       (filename))
     (end_of_statement)
+    (whitespace)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -127,65 +161,109 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
         (use_alias
           (local_name)
+          (whitespace)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
       (module_name
         (name))
+      (whitespace)
       (use_alias
         (local_name)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
+      (whitespace)
       (module_name
         (name)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
-      (included_items))
+      (included_items
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
+      (whitespace)
       (use_alias
         (local_name)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -204,48 +282,69 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (intrinsic_type)
       (implicit_range
         (implicit_range_letter)
+        (whitespace)
+        (whitespace)
         (implicit_range_letter))
+      (whitespace)
       (intrinsic_type
         (kind
           (number_literal)))
       (implicit_range
         (implicit_range_letter)
         (implicit_range_letter))
+      (whitespace)
       (intrinsic_type
         (kind
           (number_literal)))
       (implicit_range
         (implicit_range_letter)
+        (whitespace)
+        (whitespace)
         (implicit_range_letter))
+      (whitespace)
       (implicit_range
         (implicit_range_letter))
+      (whitespace)
       (implicit_range
         (implicit_range_letter)
         (implicit_range_letter)))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
-      (none))
+      (whitespace)
+      (none)
+      (whitespace)
+      (whitespace))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (derived_type
         (type_name))
       (implicit_range
         (implicit_range_letter))
+      (whitespace)
       (derived_type
         (type_name))
       (implicit_range
         (implicit_range_letter)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -262,17 +361,26 @@ END MODULE
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (save_statement)
     (end_of_statement)
+    (whitespace)
     (save_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -289,19 +397,28 @@ END MODULE
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (private_statement)
     (end_of_statement)
+    (whitespace)
     (private_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (operator
         (operator_name))
+      (whitespace)
       (operator
         (operator_name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -318,19 +435,28 @@ END MODULE
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (public_statement)
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (operator
         (operator_name))
+      (whitespace)
       (operator
         (operator_name)))
     (end_of_statement)
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -359,32 +485,49 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (init_declarator
         left: (identifier)
+        (whitespace)
         right: (number_literal))
+      (whitespace)
       declarator: (init_declarator
         left: (identifier)
+        (whitespace)
         right: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (assumed_size))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -393,10 +536,12 @@ END PROGRAM
             (math_expression
               left: (identifier)
               right: (number_literal)))))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (identifier)))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -404,107 +549,151 @@ END PROGRAM
             (number_literal)
             (assumed_size)))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (number_literal)))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (number_literal))))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (pointer_init_declarator
         left: (identifier)
+        (whitespace)
+        (whitespace)
         right: (identifier)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier
         (argument_list
           (extent_specifier)))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (assumed_shape))))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (assumed_size))))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (assumed_size)
           (identifier)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (assumed_size)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (character_length))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (character_length))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (number_literal))
         (character_length)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
       declarator: (init_declarator
         left: (identifier)
         right: (number_literal)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
           (keyword_argument
             name: (identifier)
             value: (identifier))))
+      (whitespace)
       attribute: (language_binding
         (identifier)
+        (whitespace)
         (keyword_argument
           name: (identifier)
           value: (string_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier
         (argument_list
           (call_expression
             (identifier)
             (argument_list
               (identifier)))))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -526,25 +715,36 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (intrinsic_type))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (intrinsic_type)
         (kind
           (identifier)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (intrinsic_type)
@@ -553,29 +753,43 @@ END PROGRAM
             (identifier)
             (argument_list
               (number_literal)))))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name)
         (kind
           (number_literal)
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (unlimited_polymorphic))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -607,6 +821,7 @@ end module foo
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (internal_procedures
@@ -614,63 +829,94 @@ end module foo
       (end_of_statement)
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (derived_type
             (intrinsic_type))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (type_name))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (derived_type
             (intrinsic_type)
             (kind
               (identifier)))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
       (subroutine
         (subroutine_statement
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (derived_type
             (unlimited_polymorphic))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (variable_declaration
           (derived_type
             (intrinsic_type)
@@ -679,13 +925,20 @@ end module foo
                 (identifier)
                 (argument_list
                   (number_literal)))))
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
         (end_subroutine_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement))))
     (end_module_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -708,70 +961,107 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_modification
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_modification
       (type_qualifier)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (extent_specifier)
+          (whitespace)
           (extent_specifier)))
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_modification
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (parameter_statement
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
         (number_literal))
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
         (number_literal))
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
             (math_expression
               (number_literal)
+              (whitespace)
+              (whitespace)
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (equivalence_statement
+      (whitespace)
       (equivalence_set
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (equivalence_set
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (save_statement
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier)
+      (whitespace)
       (common_block)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (bind_statement
       (language_binding
         (identifier))
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -811,58 +1101,83 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (do_loop_statement
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
         (number_literal)
         (number_literal))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (identifier)
+        (whitespace)
         (math_expression
           (number_literal)
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (open_statement
         (unit_identifier
           (identifier))
+        (whitespace)
         (keyword_argument
           (identifier)
           (string_literal)))
       (end_of_statement)
+      (whitespace)
       (subroutine_call
+        (whitespace)
         (identifier)
         (argument_list
           (identifier)
+          (whitespace)
           (keyword_argument
             (identifier)
             (boolean_literal))))
       (end_of_statement)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (do_loop_statement
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
         (number_literal)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
             (identifier)))
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (keyword_statement)
       (end_of_statement)
+      (whitespace)
       (keyword_statement
         (statement_label_reference))
       (end_of_statement)
+      (whitespace)
       (end_do_loop_statement))
     (end_of_statement)
+    (whitespace)
     (do_loop_statement
       (block_label_start_expression)
+      (whitespace)
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
         (number_literal)
         (call_expression
           (identifier)
@@ -874,50 +1189,78 @@ END PROGRAM
                   (number_literal)
                   (identifier)))))))
       (end_of_statement)
+      (whitespace)
       (do_loop_statement
+        (whitespace)
         (loop_control_expression
           (identifier)
+          (whitespace)
           (number_literal)
           (number_literal)
+          (whitespace)
           (unary_expression
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (keyword_statement
+          (whitespace)
           (identifier))
         (end_of_statement)
-        (end_do_loop_statement))
+        (whitespace)
+        (end_do_loop_statement
+          (whitespace)))
       (end_of_statement)
+      (whitespace)
       (end_do_loop_statement
+        (whitespace)
+        (whitespace)
         (block_label)))
     (end_of_statement)
+    (whitespace)
     (do_loop_statement
+      (whitespace)
       (while_statement
+        (whitespace)
         (parenthesized_expression
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (identifier)
+        (whitespace)
         (number_literal))
       (end_of_statement)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (do_loop_statement
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
         (number_literal)
         (number_literal))
       (end_of_statement)
+      (whitespace)
       (if_statement
         (inline_if_statement
+          (whitespace)
           (parenthesized_expression
             (identifier))
+          (whitespace)
           (keyword_statement
+            (whitespace)
             (statement_label_reference))))
       (end_of_statement)
       (statement_label)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -941,36 +1284,54 @@ END PROGRAM TEST
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
       attribute: (type_qualifier
         (argument_list
           (identifier)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
+      (whitespace)
       declarator: (identifier)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (number_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (identifier)
+      (whitespace)
       right: (number_literal))
     (end_of_statement)
+    (whitespace)
     (do_loop_statement
+      (whitespace)
       (concurrent_statement
         (concurrent_header
+          (whitespace)
           (concurrent_control
             (identifier)
+            (whitespace)
             initial: (number_literal)
             final: (identifier))
+          (whitespace)
           (concurrent_mask
             (relational_expression
               left: (call_expression
@@ -978,54 +1339,80 @@ END PROGRAM TEST
                 (argument_list
                   (identifier)))
               right: (number_literal))))
+        (whitespace)
         (concurrent_locality
+          (whitespace)
           (identifier))
+        (whitespace)
         (concurrent_locality
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))
+        (whitespace)
         (concurrent_locality
           (binary_op)
           (identifier)
+          (whitespace)
           (identifier))
+        (whitespace)
         (concurrent_locality
           (binary_op)
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         left: (identifier)
+        (whitespace)
+        (whitespace)
         right: (call_expression
           (identifier)
+          (whitespace)
           (argument_list
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier))))))
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         left: (call_expression
           (identifier)
           (argument_list
             (identifier)))
+        (whitespace)
+        (whitespace)
         right: (math_expression
           left: (call_expression
             (identifier)
             (argument_list
               (identifier)))
+          (whitespace)
+          (whitespace)
           right: (identifier)))
       (end_of_statement)
-      (end_do_loop_statement))
+      (whitespace)
+      (end_do_loop_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier)
+      (whitespace)
       (output_item_list
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1049,53 +1436,77 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (do_label_statement
       (statement_label_reference)
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
         (number_literal)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (do_label_statement
       (statement_label_reference)
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
         (number_literal)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)
+          (whitespace)
           (identifier)))
+      (whitespace)
+      (whitespace)
       (math_expression
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (do_label_statement
       (statement_label_reference)
+      (whitespace)
       (loop_control_expression
         (identifier)
+        (whitespace)
         (number_literal)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_do_label_statement
-      (statement_label))
+      (statement_label)
+      (whitespace)
+      (whitespace))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -1113,24 +1524,32 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (keyword_statement
+      (whitespace)
       (statement_label_reference)
       (statement_label_reference)
       (statement_label_reference)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (keyword_statement
+      (whitespace)
       (statement_label_reference)
       (statement_label_reference)
       (statement_label_reference)
+      (whitespace)
       (call_expression
         (identifier)
         (argument_list
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1169,18 +1588,24 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (if_statement
       (inline_if_statement
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
             (number_literal)))
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (inline_if_statement
         (parenthesized_expression
@@ -1195,8 +1620,10 @@ END PROGRAM
           (identifier)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (block_if_statement
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (call_expression
@@ -1205,16 +1632,24 @@ END PROGRAM
                 (extent_specifier
                   (number_literal)
                   (number_literal))))
+            (whitespace)
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (string_literal)))))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (call_expression
@@ -1223,6 +1658,8 @@ END PROGRAM
                   (extent_specifier
                     (number_literal)
                     (number_literal))))
+              (whitespace)
+              (whitespace)
               (call_expression
                 (identifier)
                 (argument_list
@@ -1230,12 +1667,18 @@ END PROGRAM
                     (identifier)
                     (argument_list
                       (number_literal)))))))
+          (whitespace)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
             (number_literal))
           (end_of_statement))
+        (whitespace)
         (elseif_clause
+          (whitespace)
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (call_expression
@@ -1244,6 +1687,8 @@ END PROGRAM
                   (extent_specifier
                     (number_literal)
                     (number_literal))))
+              (whitespace)
+              (whitespace)
               (call_expression
                 (identifier)
                 (argument_list
@@ -1251,40 +1696,62 @@ END PROGRAM
                     (identifier)
                     (argument_list
                       (number_literal)))))))
+          (whitespace)
           (end_of_statement))
+        (whitespace)
         (else_clause
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
             (number_literal))
           (end_of_statement))
+        (whitespace)
         (end_if_statement)))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (block_if_statement
         (block_label_start_expression)
+        (whitespace)
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (elseif_clause
+          (whitespace)
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
               (number_literal)))
+          (whitespace)
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
             (number_literal))
           (end_of_statement)
+          (whitespace)
           (if_statement
             (block_if_statement
+              (whitespace)
               (parenthesized_expression
                 (call_expression
                   (identifier)
@@ -1292,30 +1759,46 @@ END PROGRAM
                     (extent_specifier
                       (number_literal)
                       (number_literal)))))
+              (whitespace)
               (end_of_statement)
+              (whitespace)
               (assignment_statement
                 (identifier)
+                (whitespace)
                 (number_literal))
               (end_of_statement)
+              (whitespace)
               (else_clause
                 (end_of_statement)
+                (whitespace)
                 (assignment_statement
                   (identifier)
+                  (whitespace)
                   (number_literal))
                 (end_of_statement))
-              (end_if_statement)))
+              (whitespace)
+              (end_if_statement
+                (whitespace))))
           (end_of_statement))
+        (whitespace)
         (else_clause
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
             (number_literal))
           (end_of_statement))
+        (whitespace)
         (end_if_statement
+          (whitespace)
+          (whitespace)
           (block_label))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1350,6 +1833,7 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (where_statement
@@ -1357,11 +1841,17 @@ end program
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
+            (whitespace)
             (identifier)))))
     (end_of_statement)
     (where_statement
@@ -1369,36 +1859,54 @@ end program
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
         (elsewhere_clause
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
               (number_literal)))
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (math_expression
               (identifier)
+              (whitespace)
               (number_literal)))
           (end_of_statement))
         (elsewhere_clause
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (boolean_literal))
           (end_of_statement))
         (end_where_statement)))
@@ -1406,41 +1914,60 @@ end program
     (where_statement
       (block_where_statement
         (block_label_start_expression)
+        (whitespace)
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
         (elsewhere_clause
+          (whitespace)
           (parenthesized_expression
             (relational_expression
               (identifier)
+              (whitespace)
               (number_literal)))
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (math_expression
               (identifier)
+              (whitespace)
               (number_literal)))
           (end_of_statement))
         (elsewhere_clause
+          (whitespace)
           (block_label)
           (end_of_statement)
+          (whitespace)
           (assignment_statement
             (identifier)
+            (whitespace)
+            (whitespace)
             (boolean_literal))
           (end_of_statement))
         (end_where_statement
+          (whitespace)
           (block_label))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1470,37 +1997,50 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (forall_statement
       (inline_forall_statement
         (triplet_spec
           (identifier)
+          (whitespace)
           (number_literal)
           (identifier))
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
           (number_literal)
           (identifier))
+        (whitespace)
         (relational_expression
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
           (number_literal))
+        (whitespace)
         (assignment_statement
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
           (math_expression
             (number_literal)
+            (whitespace)
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier)
+                (whitespace)
                 (identifier)))))))
     (end_of_statement)
     (forall_statement
@@ -1509,6 +2049,7 @@ END PROGRAM
           (identifier)
           (number_literal)
           (number_literal))
+        (whitespace)
         (pointer_association_statement
           (derived_type_member_expression
             (call_expression
@@ -1516,6 +2057,8 @@ END PROGRAM
               (argument_list
                 (identifier)))
             (type_member))
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
@@ -1531,15 +2074,20 @@ END PROGRAM
     (end_of_statement)
     (forall_statement
       (block_forall_statement
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
           (number_literal)
           (identifier))
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
           (number_literal)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (where_statement
           (inline_where_statement
             (parenthesized_expression
@@ -1548,52 +2096,71 @@ END PROGRAM
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (identifier)))
+                (whitespace)
                 (number_literal)))
+            (whitespace)
             (assignment_statement
               (call_expression
                 (identifier)
                 (argument_list
                   (identifier)
+                  (whitespace)
                   (identifier)))
+              (whitespace)
               (math_expression
                 (number_literal)
                 (call_expression
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (identifier)))))))
         (end_of_statement)
-        (end_forall_statement)))
+        (end_forall_statement
+          (whitespace))))
     (end_of_statement)
     (forall_statement
       (block_forall_statement
         (triplet_spec
           (identifier)
+          (whitespace)
           (number_literal)
           (math_expression
             (identifier)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (triplet_spec
           (identifier)
+          (whitespace)
           (number_literal)
           (math_expression
             (identifier)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (relational_expression
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
+          (whitespace)
           (math_expression
             (math_expression
               (math_expression
@@ -1601,46 +2168,67 @@ END PROGRAM
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (math_expression
                       (identifier)
+                      (whitespace)
                       (number_literal))))
+                (whitespace)
+                (whitespace)
                 (call_expression
                   (identifier)
                   (argument_list
                     (identifier)
+                    (whitespace)
                     (math_expression
                       (identifier)
+                      (whitespace)
                       (number_literal)))))
+              (whitespace)
+              (whitespace)
               (call_expression
                 (identifier)
                 (argument_list
                   (math_expression
                     (identifier)
+                    (whitespace)
                     (number_literal))
+                  (whitespace)
                   (identifier))))
+            (whitespace)
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (math_expression
                   (identifier)
+                  (whitespace)
                   (number_literal))
+                (whitespace)
                 (identifier)))))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier)))
+          (whitespace)
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (identifier)
+              (whitespace)
               (identifier))))
         (end_of_statement)
-        (end_forall_statement)))
+        (end_forall_statement
+          (whitespace))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1678,105 +2266,157 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (select_case_statement
       (block_label_start_expression)
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
+            (whitespace)
             (unary_expression
               (number_literal))))
+        (whitespace)
         (block_label)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (unary_expression
             (number_literal)))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
+        (whitespace)
         (block_label)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
           (number_literal))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
-            (number_literal)))
+            (number_literal)
+            (whitespace)))
+        (whitespace)
         (block_label)
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
           (number_literal))
         (end_of_statement))
+      (whitespace)
       (end_select_statement
+        (whitespace)
+        (whitespace)
         (block_label)))
     (end_of_statement)
+    (whitespace)
     (select_case_statement
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
             (string_literal)
+            (whitespace)
             (string_literal))
           (extent_specifier
             (string_literal)
+            (whitespace)
             (string_literal)))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
           (output_item_list
             (string_literal)))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (extent_specifier
             (string_literal)
+            (whitespace)
             (string_literal)))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
           (output_item_list
             (string_literal)))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (case_value_range_list
           (identifier))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
           (output_item_list
             (string_literal)))
         (end_of_statement))
+      (whitespace)
       (case_statement
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier)
           (output_item_list
             (string_literal)))
         (end_of_statement))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (select_case_statement
+      (whitespace)
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1799,34 +2439,46 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (string_literal)
+        (whitespace)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)
         (string_literal)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
@@ -1835,6 +2487,7 @@ END PROGRAM
         (string_literal)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
@@ -1847,6 +2500,7 @@ END PROGRAM
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
@@ -1855,21 +2509,25 @@ END PROGRAM
         (hollerith_constant)
         (edit_descriptor)
         (edit_descriptor)
+        (whitespace)
         (edit_descriptor)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
         (hollerith_constant)))
     (end_of_statement)
     (statement_label)
+    (whitespace)
     (format_statement
       (transfer_items
         (edit_descriptor)
         (hollerith_constant)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1892,36 +2550,50 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (read_statement
+      (whitespace)
       (format_identifier)
+      (whitespace)
       (input_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (format_identifier
         (statement_label_reference))
+      (whitespace)
       (input_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier
         (number_literal))
       (format_identifier
         (statement_label_reference))
+      (whitespace)
       (input_item_list
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier
         (number_literal))
@@ -1930,34 +2602,43 @@ END PROGRAM
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (format_identifier
         (string_literal))
+      (whitespace)
       (input_item_list
         (call_expression
           (identifier)
           (argument_list
             (extent_specifier)))))
     (end_of_statement)
+    (whitespace)
     (read_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal))
+      (whitespace)
       (input_item_list
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -1976,24 +2657,35 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier))
     (end_of_statement)
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier)
       (output_item_list
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (print_statement
+      (whitespace)
       (format_identifier
         (identifier))
+      (whitespace)
       (output_item_list
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier
         (string_literal))
@@ -2001,6 +2693,7 @@ END PROGRAM
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2023,63 +2716,82 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (write_statement
       (unit_identifier))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier)
+      (whitespace)
       (format_identifier)
       (output_item_list
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (number_literal))
       (format_identifier
         (statement_label_reference))
+      (whitespace)
       (output_item_list
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (identifier))
       (format_identifier
         (string_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (format_identifier
         (string_literal))
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
           (argument_list
             (extent_specifier)))))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal))
+      (whitespace)
       (output_item_list
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (number_literal))
@@ -2088,14 +2800,17 @@ END PROGRAM
       (output_item_list
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (write_statement
       (unit_identifier
         (number_literal))
+      (whitespace)
       (format_identifier)
       (output_item_list
         (string_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2121,51 +2836,79 @@ end function test4
 (translation_unit
   (function
     (function_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (import_statement
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (import_statement
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (import_statement)
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (derived_type
         (type_name))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (function
     (function_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (import_statement
+      (whitespace)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_function_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2184,34 +2927,48 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (sized_declarator
           (identifier)
           (size
             (number_literal)))
+        (whitespace)
         (sized_declarator
           (identifier)
           (size
             (number_literal)
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (common_statement
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2229,29 +2986,44 @@ END PROGRAM
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (namelist_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
         (identifier))
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2273,35 +3045,58 @@ END PROGRAM test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (enum
       (enum_statement
+        (whitespace)
         (language_binding
           (identifier))
         (end_of_statement))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
+        (whitespace)
         declarator: (init_declarator
           left: (identifier)
+          (whitespace)
           right: (number_literal)))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
         declarator: (identifier)
+        (whitespace)
         declarator: (identifier))
-      (end_enum_statement))
+      (whitespace)
+      (end_enum_statement
+        (whitespace)))
     (end_of_statement)
+    (whitespace)
     (enum
       (enum_statement
+        (whitespace)
         (language_binding
           (identifier))
         (end_of_statement))
+      (whitespace)
       (enumerator_statement
+        (whitespace)
+        (whitespace)
         declarator: (init_declarator
           left: (identifier)
+          (whitespace)
+          (whitespace)
           right: (unary_expression
             argument: (number_literal))))
-      (end_enum_statement))
+      (whitespace)
+      (end_enum_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2333,31 +3128,46 @@ end subroutine print_decorated_numbers
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (derived_type
         (unlimited_polymorphic))
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (select_type_statement
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier
             (string_literal))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type
           (kind
             (call_expression
@@ -2365,14 +3175,19 @@ end subroutine print_decorated_numbers
               (argument_list
                 (number_literal)))))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier
             (string_literal))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type
           (kind
             (call_expression
@@ -2380,46 +3195,65 @@ end subroutine print_decorated_numbers
               (argument_list
                 (number_literal)))))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier
             (string_literal))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (intrinsic_type)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier
             (string_literal))
+          (whitespace)
           (output_item_list
             (identifier)))
         (end_of_statement))
+      (whitespace)
       (type_statement
+        (whitespace)
+        (whitespace)
         (identifier)
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier
             (string_literal))
+          (whitespace)
           (output_item_list
             (derived_type_member_expression
               (identifier)
               (type_member))))
         (end_of_statement))
+      (whitespace)
       (type_statement
-        (class_default)
+        (class_default
+          (whitespace))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
           (format_identifier
             (string_literal)))
         (end_of_statement))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2445,51 +3279,67 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (close_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (keyword_argument
         (identifier)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (close_statement
       (unit_identifier
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
         (string_literal)))
     (end_of_statement)
+    (whitespace)
     (open_statement
       (unit_identifier
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (close_statement
       (unit_identifier
         (number_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2517,60 +3367,87 @@ end subroutine assumed_rank
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (assumed_rank))))
     (end_of_statement)
+    (whitespace)
     (select_rank_statement
+      (whitespace)
       (selector
         (identifier))
       (end_of_statement)
+      (whitespace)
       (rank_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier)
           (output_item_list
             (string_literal)))
         (end_of_statement))
+      (whitespace)
       (rank_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier)
           (output_item_list
             (string_literal)))
         (end_of_statement))
+      (whitespace)
       (rank_statement
+        (whitespace)
         (case_value_range_list
           (number_literal))
         (end_of_statement)
+        (whitespace)
         (write_statement
           (unit_identifier)
+          (whitespace)
           (format_identifier)
           (output_item_list
             (string_literal)))
         (end_of_statement))
+      (whitespace)
       (rank_statement
+        (whitespace)
         (end_of_statement)
+        (whitespace)
         (stop_statement
+          (whitespace)
           (string_literal))
         (end_of_statement))
-      (end_select_statement))
+      (whitespace)
+      (end_select_statement
+        (whitespace)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -2591,38 +3468,58 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (associate_statement
       (association
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (association
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (end_of_statement)
+      (whitespace)
       (associate_statement
         (block_label_start_expression)
         (association
           (identifier)
+          (whitespace)
+          (whitespace)
           (call_expression
             (derived_type_member_expression
               (identifier)
               (type_member))
             (argument_list)))
         (end_of_statement)
+        (whitespace)
         (assignment_statement
           (identifier)
+          (whitespace)
+          (whitespace)
           (math_expression
             (identifier)
+            (whitespace)
             (number_literal)))
         (end_of_statement)
+        (whitespace)
         (end_associate_statement
+          (whitespace)
+          (whitespace)
           (block_label)))
       (end_of_statement)
-      (end_associate_statement))
+      (whitespace)
+      (end_associate_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2653,77 +3550,122 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (operator
           (operator_name))
         (end_of_statement))
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (operator
           (operator_name))
         (end_of_statement))
+      (whitespace)
       (function
         (function_statement
           (intrinsic_type)
+          (whitespace)
+          (whitespace)
           (name)
           (parameters
             (identifier)
+            (whitespace)
             (identifier))
           (end_of_statement))
+        (whitespace)
         (variable_declaration
           (intrinsic_type)
+          (whitespace)
           (type_qualifier)
+          (whitespace)
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))
         (end_of_statement)
+        (whitespace)
         (end_function_statement
+          (whitespace)
+          (whitespace)
           (name)
           (end_of_statement)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (unary_expression
           (user_defined_operator
-            (user_defined_operator_name))
+            (whitespace)
+            (user_defined_operator_name)
+            (whitespace))
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (math_expression
           (identifier)
+          (whitespace)
           (user_defined_operator
             (user_defined_operator_name))
+          (whitespace)
           (identifier))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2759,73 +3701,125 @@ end module
 (translation_unit
   (module
     (module_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (use_statement
+      (whitespace)
       (module_name
         (name))
       (included_items
+        (whitespace)
+        (whitespace)
+        (whitespace)
         (defined_io_procedure)
+        (whitespace)
         (defined_io_procedure)))
     (end_of_statement)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (public_statement
+      (whitespace)
+      (whitespace)
       (defined_io_procedure))
     (end_of_statement)
+    (whitespace)
     (private_statement
+      (whitespace)
+      (whitespace)
       (defined_io_procedure))
     (end_of_statement)
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (defined_io_procedure)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
         (end_of_statement)))
+    (whitespace)
     (interface
       (interface_statement
+        (whitespace)
         (defined_io_procedure)
         (end_of_statement))
+      (whitespace)
       (procedure_statement
-        (procedure_kind)
+        (procedure_kind
+          (whitespace))
+        (whitespace)
         (method_name
           (name)))
+      (whitespace)
       (end_interface_statement
+        (whitespace)
+        (whitespace)
         (defined_io_procedure)
         (end_of_statement)))
+    (whitespace)
     (derived_type_definition
       (derived_type_statement
+        (whitespace)
         (type_name)
         (end_of_statement))
+      (whitespace)
       (derived_type_procedures
         (contains_statement)
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (defined_io_procedure))
+            (whitespace)
+            (whitespace)
             (method_name
               (name))))
+        (whitespace)
         (comment)
+        (whitespace)
         (procedure_statement
           (procedure_kind)
+          (whitespace)
           (procedure_attribute)
+          (whitespace)
+          (whitespace)
           (binding
             (binding_name
               (identifier))
+            (whitespace)
+            (whitespace)
             (method_name
               (name)))))
+      (whitespace)
       (end_type_statement
+        (whitespace)
+        (whitespace)
         (name)
         (end_of_statement)))
     (end_module_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -2859,17 +3853,24 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (data_value
           (number_literal)
           (number_literal)))
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal)
           (number_literal)))
@@ -2879,37 +3880,58 @@ end program test
           (number_literal)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
-          (null_literal))))
+          (whitespace)
+          (null_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
-          (boolean_literal))))
+          (whitespace)
+          (boolean_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (derived_type_member_expression
           (identifier)
           (type_member))
+        (whitespace)
         (data_value
-          (string_literal))))
+          (string_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
+          (whitespace)
           (call_expression
             (identifier)
             (argument_list
               (number_literal)
-              (string_literal))))))
+              (string_literal)))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (implied_do_loop_expression
           (call_expression
@@ -2921,69 +3943,105 @@ end program test
             (identifier)
             (number_literal)
             (identifier)))
+        (whitespace)
         (data_value
           (number_literal)
+          (whitespace)
           (unary_expression
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (call_expression
           (identifier)
           (argument_list
             (extent_specifier)
+            (whitespace)
             (identifier)))
+        (whitespace)
         (data_value
           (number_literal
             (identifier))
           (number_literal
-            (identifier)))))
+            (identifier))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
+          (whitespace)
           (complex_literal
             (number_literal)
-            (number_literal))
+            (number_literal)
+            (whitespace))
+          (whitespace)
           (complex_literal
             (number_literal)
-            (number_literal)))))
+            (number_literal)
+            (whitespace))
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
+        (whitespace)
         (data_value
           (number_literal)
+          (whitespace)
           (number_literal)
           (number_literal)
+          (whitespace)
+          (whitespace)
           (identifier)
           (number_literal)
-          (number_literal))))
+          (number_literal)
+          (whitespace))))
     (end_of_statement)
+    (whitespace)
     (data_statement
+      (whitespace)
       (data_set
         (identifier)
         (data_value
+          (whitespace)
           (identifier)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (comment)
+    (whitespace)
     (comment)
+    (whitespace)
     (comment)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
+    (whitespace)
     (comment)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3014,37 +4072,49 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (number_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (derived_type_member_expression
           (identifier)
           (type_member)))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (parenthesized_expression
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (parenthesized_expression
@@ -3053,26 +4123,33 @@ end program
             (argument_list
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
+      (whitespace)
       (unit_identifier
         (number_literal))
+      (whitespace)
       (keyword_argument
         (identifier)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (unit_identifier
         (parenthesized_expression
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (file_position_statement
       (string_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -3090,37 +4167,61 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (inquire_statement
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (output_item_list
         (call_expression
           (identifier)
+          (whitespace)
           (argument_list
             (extent_specifier
               (number_literal)
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (inquire_statement
+      (whitespace)
       (unit_identifier
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier))
+      (whitespace)
       (keyword_argument
         (identifier)
+        (whitespace)
+        (whitespace)
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3149,8 +4250,10 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (allocate_statement
       allocation: (sized_allocation
         (identifier)
@@ -3158,28 +4261,36 @@ end program test
           (number_literal)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       type: (intrinsic_type)
       allocation: (identifier))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       type: (identifier)
       allocation: (identifier)
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier)))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
-      type: (intrinsic_type)
+      type: (intrinsic_type
+        (whitespace))
       allocation: (identifier))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       type: (identifier)
       allocation: (sized_allocation
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       allocation: (identifier)
+      (whitespace)
       allocation: (sized_allocation
         (derived_type_member_expression
           (derived_type_member_expression
@@ -3189,10 +4300,12 @@ end program test
         (size
           (number_literal)
           (number_literal)))
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier)))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       allocation: (sized_allocation
         (derived_type_member_expression
@@ -3203,42 +4316,56 @@ end program test
           (type_member))
         (size
           (identifier)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (identifier))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (derived_type_member_expression
         (identifier)
         (type_member)))
     (end_of_statement)
+    (whitespace)
     (deallocate_statement
       (identifier)
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier))
+      (whitespace)
       (keyword_argument
         name: (identifier)
         value: (identifier)))
     (end_of_statement)
+    (whitespace)
     (nullify_statement
       (identifier))
     (end_of_statement)
+    (whitespace)
     (nullify_statement
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (nullify_statement
       (derived_type_member_expression
         (identifier)
         (type_member)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3252,8 +4379,10 @@ end
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (program
     (arithmetic_if_statement
+      (whitespace)
       (parenthesized_expression
         (identifier))
       (statement_label_reference)
@@ -3285,64 +4414,101 @@ Statement Functions (Obsolescent)
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
+        (whitespace)
         (identifier)
-        (identifier))
+        (whitespace)
+        (identifier)
+        (whitespace))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (comment)
     (comment)
+    (whitespace)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
-          (identifier)))
+          (whitespace)
+          (identifier)
+          (whitespace)))
+      (whitespace)
+      (whitespace)
       (math_expression
         (call_expression
           (identifier)
           (argument_list
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
-                (identifier)))))
+                (whitespace)
+                (identifier)
+                (whitespace)))
+            (whitespace)))
+        (whitespace)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
-                (identifier)))))))
+                (whitespace)
+                (identifier)
+                (whitespace)))
+            (whitespace)))))
     (end_of_statement)
     (comment)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (parameter_statement
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
         (number_literal))
+      (whitespace)
       (parameter_assignment
         (identifier)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (string_literal))
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3371,59 +4537,87 @@ Entry statement (Obsolescent)
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (sized_declarator
         (identifier)
         (character_length)))
     (end_of_statement)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (entry_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (entry_statement
+      (whitespace)
       (name))
     (end_of_statement)
+    (whitespace)
     (keyword_statement)
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
       (end_of_statement)))
+  (whitespace)
   (subroutine
     (subroutine_statement
+      (whitespace)
       (name)
       (parameters
         (identifier))
       (end_of_statement))
+    (whitespace)
     (entry_statement
+      (whitespace)
       (name)
       (parameters
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3443,16 +4637,23 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (coarray_declarator
         (identifier)
         (coarray_size)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (coarray_declarator
         (identifier)
         (coarray_size
@@ -3464,16 +4665,24 @@ end program test
           (extent_specifier
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
       (type_qualifier
         (coarray_size
           (extent_specifier)))
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (coarray_declarator
           (sized_declarator
@@ -3482,6 +4691,7 @@ end program test
               (identifier)))
           (coarray_size))
         (identifier))
+      (whitespace)
       (init_declarator
         (coarray_declarator
           (sized_declarator
@@ -3492,6 +4702,8 @@ end program test
         (identifier)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3512,23 +4724,30 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (print_statement
       (format_identifier)
+      (whitespace)
       (output_item_list
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (coarray_expression
         (identifier)
         (coarray_index
           (number_literal)))
+      (whitespace)
+      (whitespace)
       (boolean_literal))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       (coarray_expression
         (call_expression
@@ -3537,6 +4756,8 @@ end program test
             (extent_specifier)))
         (coarray_index
           (identifier)))
+      (whitespace)
+      (whitespace)
       (math_expression
         (coarray_expression
           (call_expression
@@ -3547,22 +4768,31 @@ end program test
             (identifier)))
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (if_statement
       (inline_if_statement
         (parenthesized_expression
           (relational_expression
             (identifier)
+            (whitespace)
             (number_literal)))
+        (whitespace)
         (assignment_statement
           (coarray_expression
             (identifier)
             (coarray_index
               (number_literal)
+              (whitespace)
               (keyword_argument
                 (identifier)
+                (whitespace)
+                (whitespace)
                 (identifier))))
+          (whitespace)
+          (whitespace)
           (identifier))))
     (end_of_statement)
+    (whitespace)
     (allocate_statement
       (coarray_allocation
         (sized_allocation
@@ -3572,6 +4802,8 @@ end program test
         (coarray_size)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3595,57 +4827,78 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (number_literal)))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (array_literal
           (number_literal)
           (number_literal))))
     (end_of_statement)
-    (coarray_statement)
+    (whitespace)
+    (coarray_statement
+      (whitespace))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (number_literal)
+        (whitespace)
         (call_expression
           (identifier)
           (argument_list
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (call_expression
           (identifier)
           (argument_list
             (identifier)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (identifier)
+        (whitespace)
         (keyword_argument
           (identifier)
           (number_literal))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3668,51 +4921,75 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (coarray_statement
+      (whitespace)
       (argument_list
         (identifier)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (coarray_team_statement
+      (whitespace)
       (argument_list
         (identifier))
       (end_of_statement)
+      (whitespace)
       (coarray_statement
+        (whitespace)
         (argument_list
           (identifier)
+          (whitespace)
           (identifier)))
       (end_of_statement)
+      (whitespace)
       (coarray_team_statement
         (block_label_start_expression)
+        (whitespace)
+        (whitespace)
         (argument_list
           (identifier))
         (end_of_statement)
+        (whitespace)
         (print_statement
           (format_identifier)
+          (whitespace)
           (output_item_list
             (call_expression
               (identifier)
               (argument_list))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))
+            (whitespace)
             (call_expression
               (identifier)
               (argument_list
                 (identifier)))))
         (end_of_statement)
+        (whitespace)
         (end_coarray_team_statement
+          (whitespace)
+          (whitespace)
           (block_label)))
       (end_of_statement)
-      (end_coarray_team_statement))
+      (whitespace)
+      (end_coarray_team_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3731,20 +5008,29 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (coarray_critical_statement
       (end_of_statement)
+      (whitespace)
       (assignment_statement
         (coarray_expression
           (identifier)
           (coarray_index
             (number_literal)))
+        (whitespace)
+        (whitespace)
         (boolean_literal))
       (end_of_statement)
-      (end_coarray_critical_statement))
+      (whitespace)
+      (end_coarray_critical_statement
+        (whitespace)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3763,20 +5049,32 @@ end program test;
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
+    (whitespace)
     (assignment_statement
       (identifier)
+      (whitespace)
       (number_literal))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3793,16 +5091,24 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
       (type_qualifier)
+      (whitespace)
+      (whitespace)
       (init_declarator
         (identifier)
+        (whitespace)
         (number_literal)))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3822,22 +5128,34 @@ end subroutine test
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
       parameters: (parameters
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier)
+        (whitespace)
         (identifier))
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (declared_type
         name: (identifier))
+      (whitespace)
       attribute: (type_qualifier)
+      (whitespace)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -3846,19 +5164,27 @@ end subroutine test
             (argument_list
               (identifier))))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (derived_type
         name: (type_name))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (declared_type
         name: (derived_type_member_expression
           (identifier)
           (type_member)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -3872,9 +5198,12 @@ end
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (program
     (assign_statement
       (number_literal)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
     (end_program_statement
@@ -3890,6 +5219,7 @@ end
 --------------------------------------------------------------------------------
 
 (translation_unit
+  (whitespace)
   (program
     (keyword_statement
       (number_literal))
@@ -3910,15 +5240,20 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (keyword_statement
+      (whitespace)
       (identifier)
+      (whitespace)
       (statement_label_reference)
       (statement_label_reference)
       (statement_label_reference))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -3943,34 +5278,47 @@ end subroutine pointer_name_clash
 (translation_unit
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
+      (whitespace)
       parameters: (parameters
-        (identifier))
+        (whitespace)
+        (identifier)
+        (whitespace))
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (sized_declarator
         (identifier)
         (size
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (number_literal)))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
           (identifier)))
+      (whitespace)
       declarator: (sized_declarator
         (identifier)
         (size
@@ -3980,51 +5328,81 @@ end subroutine pointer_name_clash
               right: (identifier))
             right: (number_literal)))))
     (end_of_statement)
+    (whitespace)
     (cray_pointer_declaration
+      (whitespace)
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier))
+        (whitespace)
+        target: (identifier)
+        (whitespace))
+      (whitespace)
       (cray_pointer_pair
         pointer: (identifier)
+        (whitespace)
         target: (sized_declarator
           (identifier)
           (size
             (extent_specifier
               (number_literal)
-              (number_literal)))))
+              (number_literal))))
+        (whitespace))
+      (whitespace)
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier))
+        (whitespace)
+        target: (identifier)
+        (whitespace))
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier))
+        (whitespace)
+        target: (identifier)
+        (whitespace))
+      (whitespace)
       (cray_pointer_pair
+        (whitespace)
         pointer: (identifier)
-        target: (identifier)))
+        (whitespace)
+        target: (identifier)
+        (whitespace)))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement)))
   (subroutine
     (subroutine_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       attribute: (type_qualifier
         (argument_list
           (number_literal)))
+      (whitespace)
+      (whitespace)
       declarator: (identifier))
     (end_of_statement)
+    (whitespace)
     (assignment_statement
       left: (call_expression
         (identifier)
         (argument_list
           (number_literal)
           (number_literal)))
+      (whitespace)
       right: (number_literal))
     (end_of_statement)
     (end_subroutine_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
 
@@ -4044,13 +5422,18 @@ end program
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       name: (name)
       (end_of_statement))
+    (whitespace)
     (implicit_statement
+      (whitespace)
       (none))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (data_declarator
         left: (sized_declarator
           (identifier)
@@ -4060,6 +5443,7 @@ end program
           repeat: (number_literal)
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type
         kind: (kind
@@ -4075,8 +5459,10 @@ end program
         right: (data_value
           (number_literal))))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       type: (intrinsic_type)
+      (whitespace)
       declarator: (data_declarator
         left: (identifier)
         right: (data_value
@@ -4085,6 +5471,7 @@ end program
             (number_literal)))))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
       (end_of_statement))))
 
 ================================================================================
@@ -4102,22 +5489,34 @@ end program test
 (translation_unit
   (program
     (program_statement
+      (whitespace)
       (name)
       (end_of_statement))
+    (whitespace)
     (common_statement
+      (whitespace)
       (variable_group
         (name)
+        (whitespace)
         (identifier)))
     (end_of_statement)
+    (whitespace)
     (variable_declaration
       (intrinsic_type)
+      (whitespace)
+      (whitespace)
       (identifier))
     (end_of_statement)
+    (whitespace)
     (bind_statement
       (language_binding
         (identifier))
+      (whitespace)
+      (whitespace)
       (common_block))
     (end_of_statement)
     (end_program_statement
+      (whitespace)
+      (whitespace)
       (name)
       (end_of_statement))))
