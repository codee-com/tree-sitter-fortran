From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?I=C3=B1aki=20Amatria=20Barral?= <inaki.amatria@appentra.com>
Date: Fri, 17 Oct 2025 11:33:43 +0200
Subject: Unhide `_string_literal`

---
 grammar.js                         |  15 ++--
 test/corpus/constructs.txt         |  24 +++--
 test/corpus/expressions.txt        | 136 ++++++++++++++++++++++++-----
 test/corpus/line_continuations.txt |  33 ++++---
 test/corpus/preprocessor.txt       |   9 +-
 test/corpus/regressions.txt        |  33 ++++---
 test/corpus/statements.txt         | 135 ++++++++++++++++++----------
 7 files changed, 278 insertions(+), 107 deletions(-)

diff --git a/grammar.js b/grammar.js
index c6ffa3b..f1c074f 100644
--- a/grammar.js
+++ b/grammar.js
@@ -62,7 +62,7 @@ module.exports = grammar({
     $._integer_literal,
     $._float_literal,
     $._boz_literal,
-    $._string_literal,
+    $.string_literal,
     $._string_literal_kind,
     $._external_end_of_statement,
     $._preproc_unary_operator,
@@ -110,6 +110,7 @@ module.exports = grammar({
     [$.inline_if_statement, $.arithmetic_if_statement, $.block_if_statement, $.identifier],
     [$.cray_pointer_declaration, $.identifier],
     [$.unit_identifier, $.identifier],
+    [$._preproc_expression, $.prefixed_string_literal],
   ],
 
   supertypes: $ => [
@@ -1284,7 +1285,7 @@ module.exports = grammar({
         choice(
           $.number_literal,
           $.complex_literal,
-          $.string_literal,
+          $.prefixed_string_literal,
           $.boolean_literal,
           $.unary_expression,
           $.null_literal,
@@ -1837,14 +1838,14 @@ module.exports = grammar({
       ),
 
       // Deleted feature -- not quite file position statement
-      seq(caseInsensitive('pause'), optional($.string_literal)),
+      seq(caseInsensitive('pause'), optional($.prefixed_string_literal)),
     ),
 
     // This is a limited set of expressions that can be used in IO statements
     // precedence is used to override a conflict with the complex literal
     _io_expressions: $ => prec(1, choice(
       '*',
-      $.string_literal,
+      $.prefixed_string_literal,
       $.identifier,
       $.derived_type_member_expression,
       $.concatenation_expression,
@@ -1930,7 +1931,7 @@ module.exports = grammar({
     _expression: $ => choice(
       $.number_literal,
       $.complex_literal,
-      $.string_literal,
+      $.prefixed_string_literal,
       $.boolean_literal,
       $.array_literal,
       $.null_literal,
@@ -2183,7 +2184,7 @@ module.exports = grammar({
       ')',
     )),
 
-    string_literal: $ => seq(
+    prefixed_string_literal: $ => seq(
       // Having a kind _prefix_, with an underscore and no whitespace,
       // is _really_ hard to parse without breaking other things, so
       // we have to rely on an external scanner
@@ -2196,7 +2197,7 @@ module.exports = grammar({
         // also need to *capture* it here
         token.immediate('_'),
       )),
-      $._string_literal,
+      $.string_literal,
     ),
 
     // Coarrays
diff --git a/test/corpus/constructs.txt b/test/corpus/constructs.txt
index c2eb077..cb771ab 100644
--- a/test/corpus/constructs.txt
+++ b/test/corpus/constructs.txt
@@ -133,7 +133,8 @@ end module
             (identifier)
             (argument_list
               (number_literal)))
-          (string_literal))))
+          (prefixed_string_literal
+            (string_literal)))))
     (end_of_statement)
     (comment)
     (variable_declaration
@@ -147,7 +148,8 @@ end module
             (identifier)
             (argument_list
               (number_literal)))
-          (string_literal))))
+          (prefixed_string_literal
+            (string_literal)))))
     (end_of_statement)
     (comment)
     (variable_declaration
@@ -161,7 +163,8 @@ end module
             (identifier)
             (argument_list
               (number_literal)))
-          (string_literal))))
+          (prefixed_string_literal
+            (string_literal)))))
     (end_of_statement)
     (comment)
     (public_statement
@@ -627,7 +630,8 @@ END SUBROUTINE
         (identifier)
         (keyword_argument
           (identifier)
-          (string_literal)))
+          (prefixed_string_literal
+            (string_literal))))
       (end_of_statement))
     (end_subroutine_statement
       (end_of_statement)))
@@ -642,7 +646,8 @@ END SUBROUTINE
     (subroutine_call
       (identifier)
       (argument_list
-        (string_literal)
+        (prefixed_string_literal
+          (string_literal))
         (identifier)))
     (end_of_statement)
     (internal_procedures
@@ -791,7 +796,8 @@ end function
         (identifier)
         (keyword_argument
           (identifier)
-          (string_literal)))
+          (prefixed_string_literal
+            (string_literal))))
       (end_of_statement))
     (end_function_statement
       (end_of_statement)))
@@ -804,7 +810,8 @@ end function
         (identifier)
         (keyword_argument
           (identifier)
-          (string_literal)))
+          (prefixed_string_literal
+            (string_literal))))
       (end_of_statement))
     (end_function_statement
       (end_of_statement)))
@@ -815,7 +822,8 @@ end function
         (identifier)
         (keyword_argument
           (identifier)
-          (string_literal)))
+          (prefixed_string_literal
+            (string_literal))))
       (function_result
         (identifier))
       (end_of_statement))
diff --git a/test/corpus/expressions.txt b/test/corpus/expressions.txt
index a9771e1..37072de 100644
--- a/test/corpus/expressions.txt
+++ b/test/corpus/expressions.txt
@@ -191,55 +191,67 @@ END PROGRAM
       (end_of_statement))
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal))
+      right: (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
       right: (concatenation_expression
-        left: (string_literal)
+        left: (prefixed_string_literal
+          (string_literal))
         right: (concatenation_expression
-          left: (string_literal)
+          left: (prefixed_string_literal
+            (string_literal))
           right: (concatenation_expression
             left: (identifier)
             right: (identifier)))))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal
-        kind: (identifier)))
+      right: (prefixed_string_literal
+        kind: (identifier)
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       left: (identifier)
-      right: (string_literal
-        kind: (number_literal)))
+      right: (prefixed_string_literal
+        kind: (number_literal)
+        (string_literal)))
     (end_of_statement)
     (end_program_statement
       (end_of_statement))))
@@ -870,7 +882,8 @@ END PROGRAM
         (number_literal))
       (keyword_argument
         name: (identifier)
-        value: (string_literal)))
+        value: (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (assignment_statement
       left: (derived_type_member_expression
@@ -970,10 +983,12 @@ end program
     (write_statement
       (unit_identifier)
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (keyword_argument
         (identifier)
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (comment)
       (keyword_argument
         (identifier)
@@ -1008,7 +1023,8 @@ end program test
     (print_statement
       (format_identifier)
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (end_program_statement
       (name)
@@ -1201,9 +1217,12 @@ end program array_constructors
               (keyword_argument
                 (identifier)
                 (number_literal))))
-          (string_literal)
-          (string_literal)
-          (string_literal))))
+          (prefixed_string_literal
+            (string_literal))
+          (prefixed_string_literal
+            (string_literal))
+          (prefixed_string_literal
+            (string_literal)))))
     (end_of_statement)
     (end_program_statement
       (name)
@@ -1352,7 +1371,8 @@ end subroutine foo
       (concatenation_expression
         (identifier)
         (concatenation_expression
-          (string_literal)
+          (prefixed_string_literal
+            (string_literal))
           (identifier))))
     (end_of_statement)
     (assignment_statement
@@ -1564,3 +1584,75 @@ end
     (end_of_statement)
     (end_program_statement
       (end_of_statement))))
+
+================================================================================
+Valid statements with prefixed strings
+================================================================================
+
+subroutine foo()
+  integer, parameter :: k = 4
+  character(len=128, kind=k) :: baz
+
+  data baz / k_"baz" /
+
+  open(unit=1, file=1_"mux")
+
+  baz = k_"bux"
+  pause 1_"fux"
+end
+
+--------------------------------------------------------------------------------
+
+(translation_unit
+  (subroutine
+    (subroutine_statement
+      (name)
+      (end_of_statement))
+    (variable_declaration
+      (intrinsic_type)
+      (type_qualifier)
+      (init_declarator
+        (identifier)
+        (number_literal)))
+    (end_of_statement)
+    (variable_declaration
+      (intrinsic_type
+        (kind
+          (keyword_argument
+            (identifier)
+            (number_literal))
+          (keyword_argument
+            (identifier)
+            (identifier))))
+      (identifier))
+    (end_of_statement)
+    (data_statement
+      (data_set
+        (identifier)
+        (data_value
+          (prefixed_string_literal
+            (identifier)
+            (string_literal)))))
+    (end_of_statement)
+    (open_statement
+      (unit_identifier
+        (number_literal))
+      (keyword_argument
+        (identifier)
+        (prefixed_string_literal
+          (number_literal)
+          (string_literal))))
+    (end_of_statement)
+    (assignment_statement
+      (identifier)
+      (prefixed_string_literal
+        (identifier)
+        (string_literal)))
+    (end_of_statement)
+    (file_position_statement
+      (prefixed_string_literal
+        (number_literal)
+        (string_literal)))
+    (end_of_statement)
+    (end_subroutine_statement
+      (end_of_statement))))
diff --git a/test/corpus/line_continuations.txt b/test/corpus/line_continuations.txt
index c086fe8..ba12587 100644
--- a/test/corpus/line_continuations.txt
+++ b/test/corpus/line_continuations.txt
@@ -18,10 +18,12 @@ end program
     (write_statement
       (unit_identifier)
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (keyword_argument
         (identifier)
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (comment)
       (keyword_argument
         (identifier)
@@ -56,11 +58,13 @@ end program
     (write_statement
       (unit_identifier)
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (comment)
       (keyword_argument
         (identifier)
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (keyword_argument
         (identifier)
         (identifier)))
@@ -244,30 +248,37 @@ end program
     (print_statement
       (format_identifier)
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (print_statement
       (format_identifier)
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (print_statement
       (format_identifier)
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (print_statement
       (format_identifier)
       (output_item_list
         (concatenation_expression
-          (string_literal)
-          (string_literal))))
+          (prefixed_string_literal
+            (string_literal))
+          (prefixed_string_literal
+            (string_literal)))))
     (end_of_statement)
     (print_statement
       (format_identifier)
       (output_item_list
-        (string_literal)
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (end_program_statement
       (end_of_statement))))
diff --git a/test/corpus/preprocessor.txt b/test/corpus/preprocessor.txt
index b0b35bd..ea589be 100644
--- a/test/corpus/preprocessor.txt
+++ b/test/corpus/preprocessor.txt
@@ -807,7 +807,8 @@ end program
     (end_of_statement)
     (assignment_statement
       (identifier)
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (select_case_statement
       (selector
@@ -817,7 +818,8 @@ end program
         (identifier)
         (case_statement
           (case_value_range_list
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (end_of_statement)
           (assignment_statement
             (identifier)
@@ -829,7 +831,8 @@ end program
           (number_literal))
         (case_statement
           (case_value_range_list
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (end_of_statement)
           (assignment_statement
             (identifier)
diff --git a/test/corpus/regressions.txt b/test/corpus/regressions.txt
index 0b7937a..ac8d966 100644
--- a/test/corpus/regressions.txt
+++ b/test/corpus/regressions.txt
@@ -49,19 +49,22 @@ end program example_padl
     (end_of_statement)
     (assignment_statement
       (identifier)
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (comment)
     (print_statement
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (output_item_list
         (call_expression
           (identifier)
           (argument_list
             (identifier)
             (number_literal)
-            (string_literal)))))
+            (prefixed_string_literal
+              (string_literal))))))
     (end_of_statement)
     (comment)
     (assignment_statement
@@ -266,56 +269,64 @@ Multiple array assignments
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (assignment_statement
       (call_expression
         (identifier)
         (argument_list
           (identifier)))
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (print_statement
       (format_identifier)
diff --git a/test/corpus/statements.txt b/test/corpus/statements.txt
index 41a00f8..4b6d8fb 100644
--- a/test/corpus/statements.txt
+++ b/test/corpus/statements.txt
@@ -490,7 +490,8 @@ END PROGRAM
         (identifier)
         (keyword_argument
           name: (identifier)
-          value: (string_literal)))
+          value: (prefixed_string_literal
+            (string_literal))))
       declarator: (identifier))
     (end_of_statement)
     (variable_declaration
@@ -830,7 +831,8 @@ END PROGRAM
           (identifier))
         (keyword_argument
           (identifier)
-          (string_literal)))
+          (prefixed_string_literal
+            (string_literal))))
       (end_of_statement)
       (subroutine_call
         (identifier)
@@ -1208,7 +1210,8 @@ END PROGRAM
             (call_expression
               (identifier)
               (argument_list
-                (string_literal)))))
+                (prefixed_string_literal
+                  (string_literal))))))
         (end_of_statement)
         (assignment_statement
           (identifier)
@@ -1726,29 +1729,37 @@ END PROGRAM
       (case_statement
         (case_value_range_list
           (extent_specifier
-            (string_literal)
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (extent_specifier
-            (string_literal)
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement)
         (write_statement
           (unit_identifier)
           (format_identifier)
           (output_item_list
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (case_statement
         (case_value_range_list
           (extent_specifier
-            (string_literal)
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement)
         (write_statement
           (unit_identifier)
           (format_identifier)
           (output_item_list
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (case_statement
         (case_value_range_list
@@ -1758,7 +1769,8 @@ END PROGRAM
           (unit_identifier)
           (format_identifier)
           (output_item_list
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (case_statement
         (end_of_statement)
@@ -1766,7 +1778,8 @@ END PROGRAM
           (unit_identifier)
           (format_identifier)
           (output_item_list
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (end_select_statement))
     (end_of_statement)
@@ -1934,7 +1947,8 @@ END PROGRAM
       (unit_identifier
         (identifier))
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (input_item_list
         (call_expression
           (identifier)
@@ -1947,13 +1961,15 @@ END PROGRAM
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (keyword_argument
         (identifier)
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (input_item_list
         (identifier)))
     (end_of_statement)
@@ -1984,7 +2000,8 @@ END PROGRAM
     (print_statement
       (format_identifier)
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (print_statement
       (format_identifier
@@ -1996,9 +2013,11 @@ END PROGRAM
     (end_of_statement)
     (print_statement
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (end_program_statement
       (end_of_statement))))
@@ -2032,7 +2051,8 @@ END PROGRAM
       (unit_identifier)
       (format_identifier)
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (write_statement
       (unit_identifier
@@ -2048,7 +2068,8 @@ END PROGRAM
       (unit_identifier
         (identifier))
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (keyword_argument
         (identifier)
         (identifier)))
@@ -2057,7 +2078,8 @@ END PROGRAM
       (unit_identifier
         (identifier))
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (output_item_list
         (call_expression
           (identifier)
@@ -2070,13 +2092,15 @@ END PROGRAM
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (keyword_argument
         (identifier)
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (output_item_list
         (identifier)))
     (end_of_statement)
@@ -2084,16 +2108,19 @@ END PROGRAM
       (unit_identifier
         (number_literal))
       (format_identifier
-        (string_literal))
+        (prefixed_string_literal
+          (string_literal)))
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (write_statement
       (unit_identifier
         (number_literal))
       (format_identifier)
       (output_item_list
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (end_program_statement
       (end_of_statement))))
@@ -2353,7 +2380,8 @@ end subroutine print_decorated_numbers
         (write_statement
           (unit_identifier)
           (format_identifier
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (output_item_list
             (identifier)))
         (end_of_statement))
@@ -2368,7 +2396,8 @@ end subroutine print_decorated_numbers
         (write_statement
           (unit_identifier)
           (format_identifier
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (output_item_list
             (identifier)))
         (end_of_statement))
@@ -2383,7 +2412,8 @@ end subroutine print_decorated_numbers
         (write_statement
           (unit_identifier)
           (format_identifier
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (output_item_list
             (identifier)))
         (end_of_statement))
@@ -2393,7 +2423,8 @@ end subroutine print_decorated_numbers
         (write_statement
           (unit_identifier)
           (format_identifier
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (output_item_list
             (identifier)))
         (end_of_statement))
@@ -2403,7 +2434,8 @@ end subroutine print_decorated_numbers
         (write_statement
           (unit_identifier)
           (format_identifier
-            (string_literal))
+            (prefixed_string_literal
+              (string_literal)))
           (output_item_list
             (derived_type_member_expression
               (identifier)
@@ -2415,7 +2447,8 @@ end subroutine print_decorated_numbers
         (write_statement
           (unit_identifier)
           (format_identifier
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (end_select_statement))
     (end_of_statement)
@@ -2457,14 +2490,16 @@ end program test
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (close_statement
       (unit_identifier
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (open_statement
       (keyword_argument
@@ -2472,14 +2507,16 @@ end program test
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (close_statement
       (unit_identifier
         (identifier))
       (keyword_argument
         (identifier)
-        (string_literal)))
+        (prefixed_string_literal
+          (string_literal))))
     (end_of_statement)
     (open_statement
       (unit_identifier
@@ -2541,7 +2578,8 @@ end subroutine assumed_rank
           (unit_identifier)
           (format_identifier)
           (output_item_list
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (rank_statement
         (case_value_range_list
@@ -2551,7 +2589,8 @@ end subroutine assumed_rank
           (unit_identifier)
           (format_identifier)
           (output_item_list
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (rank_statement
         (case_value_range_list
@@ -2561,12 +2600,14 @@ end subroutine assumed_rank
           (unit_identifier)
           (format_identifier)
           (output_item_list
-            (string_literal)))
+            (prefixed_string_literal
+              (string_literal))))
         (end_of_statement))
       (rank_statement
         (end_of_statement)
         (stop_statement
-          (string_literal))
+          (prefixed_string_literal
+            (string_literal)))
         (end_of_statement))
       (end_select_statement))
     (end_of_statement)
@@ -2897,7 +2938,8 @@ end program test
           (identifier)
           (type_member))
         (data_value
-          (string_literal))))
+          (prefixed_string_literal
+            (string_literal)))))
     (end_of_statement)
     (data_statement
       (data_set
@@ -2907,7 +2949,8 @@ end program test
             (identifier)
             (argument_list
               (number_literal)
-              (string_literal))))))
+              (prefixed_string_literal
+                (string_literal)))))))
     (end_of_statement)
     (data_statement
       (data_set
@@ -3070,7 +3113,8 @@ end program
           (number_literal))))
     (end_of_statement)
     (file_position_statement
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (end_program_statement
       (end_of_statement))))
@@ -3340,7 +3384,8 @@ Statement Functions (Obsolescent)
     (end_of_statement)
     (assignment_statement
       (identifier)
-      (string_literal))
+      (prefixed_string_literal
+        (string_literal)))
     (end_of_statement)
     (end_subroutine_statement
       (name)
