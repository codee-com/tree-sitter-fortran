================================================================================
Number Literals
================================================================================

PROGRAM TEST
    int_val = 1
    int_val = 1_SZ1
    int_val = 1_4
    flt_val = 1.0
    flt_val = 1.
    flt_val = .1
    flt_val = 1.0_SZ1
    flt_val = 1._SZ1
    flt_val = 1.E+4
    flt_val = 1.23E+4
    flt_val = 1.23E-4
    flt_val = 1.23E4
    flt_val = 1.0e+5_SZ1
    dbl_val = 1.D+4
    dbl_val = 1.23D+4
    dbl_val = 1.23D-4
    dbl_val = 1.23D4
    dbl_val = 1.23e-4_d
    bin_val = B'1011'
    oct_val = O'0158'
    hex_val = Z'09AF'
    cpx_val = (1.0, 2.0)
    cpx_val = (dbl_val, dbl_val)
    cpx_val = (-1.0, 1.0)
    cpx_val = (1.0, -1.0)
    bool_val = .false._c_bool
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (complex_literal
        (number_literal)
        (whitespace)
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (complex_literal
        (identifier)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (complex_literal
        (unary_expression
          (number_literal))
        (whitespace)
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (complex_literal
        (number_literal)
        (whitespace)
        (unary_expression
          (number_literal))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (boolean_literal
        (identifier)))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
String Literals
================================================================================

PROGRAM TEST
    sngl_qt = ''
    sngl_qt = '123456789!<>/?@#$%&"\\"//abcdefgh''ABCDEFGH'
    dble_qt = ""
    dble_qt = "123456789!<>/?@#$%&'\\'//abcdefgh""ABCDEFGH"
    dble_qt = """double double quotes"""
    sngl_qt = '''double single quotes'''
    dble_qt = "'single in double quotes'"
    sngl_qt = '"double in single quotes"'

    val = "one"//'two'//sngl_qt//dble_qt

    with_kind = ck_"string with kind"
    with_numeral_kind = 4_"string with kind"
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      name: (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (concatenation_expression
        left: (prefixed_string_literal
          (string_literal))
        right: (concatenation_expression
          left: (prefixed_string_literal
            (string_literal))
          right: (concatenation_expression
            left: (identifier)
            right: (identifier)))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        kind: (identifier)
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (prefixed_string_literal
        kind: (number_literal)
        (string_literal)))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Boolean Literals
================================================================================

PROGRAM TEST
    bool_val = .TRUE.
    bool_val = .FALSE.
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (boolean_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (boolean_literal))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Array Literals
================================================================================

program test
  integer :: n(3) = (/ 1, 2, 3  /)
  real(8) :: x(3) = (/2.0**3, REAL(n(1)), SIN(3.1)/)
  real(8) :: z(3) = [-1.0, 0.0, 1.0]
  call append(list, (/ real(1) /))
end program

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      name: (name)
      (end_of_statement))
    (whitespace)
    (variable_declaration
      type: (intrinsic_type)
      (whitespace)
      (whitespace)
      declarator: (init_declarator
        left: (sized_declarator
          (identifier)
          (size
            (number_literal)))
        (whitespace)
        (whitespace)
        right: (array_literal
          (whitespace)
          (number_literal)
          (whitespace)
          (number_literal)
          (whitespace)
          (number_literal)
          (whitespace))))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      type: (intrinsic_type
        kind: (kind
          (number_literal)))
      (whitespace)
      (whitespace)
      declarator: (init_declarator
        left: (sized_declarator
          (identifier)
          (size
            (number_literal)))
        (whitespace)
        (whitespace)
        right: (array_literal
          (math_expression
            left: (number_literal)
            right: (number_literal))
          (whitespace)
          (call_expression
            (identifier)
            (argument_list
              (call_expression
                (identifier)
                (argument_list
                  (number_literal)))))
          (whitespace)
          (call_expression
            (identifier)
            (argument_list
              (number_literal))))))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      type: (intrinsic_type
        kind: (kind
          (number_literal)))
      (whitespace)
      (whitespace)
      declarator: (init_declarator
        left: (sized_declarator
          (identifier)
          (size
            (number_literal)))
        (whitespace)
        (whitespace)
        right: (array_literal
          (unary_expression
            argument: (number_literal))
          (whitespace)
          (number_literal)
          (whitespace)
          (number_literal))))
    (end_of_statement)
    (whitespace)
    (subroutine_call
      (whitespace)
      subroutine: (identifier)
      (argument_list
        (identifier)
        (whitespace)
        (array_literal
          (whitespace)
          (call_expression
            (identifier)
            (argument_list
              (number_literal)))
          (whitespace))))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Array Slicing
================================================================================

PROGRAM TEST
    arr(1) = 1
    arr(:) = 2
    arr(1:10) = 3
    arr(1:10:2) = 4
    arr(::2) = 5
    arr(INT(x):3*j:j) = 6
    arr(1, j, INT(SIN(r))) = 5
    arr(INT(r/3.0):j) = 4
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (number_literal)))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (extent_specifier)))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (extent_specifier
            (number_literal)
            (number_literal))))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (extent_specifier
            (number_literal)
            (number_literal)
            (number_literal))))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (extent_specifier
            (number_literal))))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (extent_specifier
            (call_expression
              (identifier)
              (argument_list
                (identifier)))
            (math_expression
              (number_literal)
              (identifier))
            (identifier))))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (number_literal)
          (whitespace)
          (identifier)
          (whitespace)
          (call_expression
            (identifier)
            (argument_list
              (call_expression
                (identifier)
                (argument_list
                  (identifier)))))))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (extent_specifier
            (call_expression
              (identifier)
              (argument_list
                (math_expression
                  (identifier)
                  (number_literal))))
            (identifier))))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Pointer Assignment
================================================================================

PROGRAM TEST
    val => x
    val(1) => x
    val%attr => x
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (pointer_association_statement
      (identifier)
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (pointer_association_statement
      (call_expression
        (identifier)
        (argument_list
          (number_literal)))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (pointer_association_statement
      (derived_type_member_expression
        (identifier)
        (type_member))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Derived Type Member Access
================================================================================

PROGRAM TEST
  val%attr = x
  x = val%attr
  val%attr(1:4) = x
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      (derived_type_member_expression
        (identifier)
        (type_member))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (derived_type_member_expression
        (identifier)
        (type_member)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (derived_type_member_expression
          (identifier)
          (type_member))
        (argument_list
          (extent_specifier
            (number_literal)
            (number_literal))))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Mathematical Expressions
================================================================================

PROGRAM TEST
    val = x + 1
    val = x - 1
    val = x * y
    val = x / y
    val = x**y
    val = -x
    val = +x
    val = r**j / k**(-2) * 7
    val = 14 + (i - j)**3
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (math_expression
        (identifier)
        (whitespace)
        (whitespace)
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (math_expression
        (identifier)
        (whitespace)
        (whitespace)
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (math_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (math_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (math_expression
        (identifier)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (unary_expression
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (unary_expression
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (math_expression
        (math_expression
          (math_expression
            (identifier)
            (identifier))
          (whitespace)
          (whitespace)
          (math_expression
            (identifier)
            (parenthesized_expression
              (unary_expression
                (number_literal)))))
        (whitespace)
        (whitespace)
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (math_expression
        (number_literal)
        (whitespace)
        (whitespace)
        (math_expression
          (parenthesized_expression
            (math_expression
              (identifier)
              (whitespace)
              (whitespace)
              (identifier)))
          (number_literal))))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Logical Expressions
================================================================================

PROGRAM TEST
    val = x < y
    val = x .LT. y
    val = x > y
    val = x .gt. y
    val = x <= y
    val = x .LE. y
    val = x >= y
    val = x .ge. y
    val = x == y
    val = x .EQ. y
    val = x /= y
    val = x .NE. y
    val = x .EQV. y
    val = x .NEQV. y
    val = x .AND. y
    val = x .or. y
    val = .NOT. x
    val = (.NOT. x == y)
    val = ((x > y) .AND. (y <= z)) .eqv. .true.
    val = 1.eq.0
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (logical_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (logical_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (logical_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (logical_expression
        (identifier)
        (whitespace)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (logical_expression
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (parenthesized_expression
        (logical_expression
          (whitespace)
          (relational_expression
            (identifier)
            (whitespace)
            (whitespace)
            (identifier)))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (logical_expression
        (parenthesized_expression
          (logical_expression
            (parenthesized_expression
              (relational_expression
                (identifier)
                (whitespace)
                (whitespace)
                (identifier)))
            (whitespace)
            (whitespace)
            (parenthesized_expression
              (relational_expression
                (identifier)
                (whitespace)
                (whitespace)
                (identifier)))))
        (whitespace)
        (whitespace)
        (boolean_literal)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (relational_expression
        (number_literal)
        (number_literal)))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Function and Subroutine Call Expressions
================================================================================

PROGRAM TEST
    nargs = command_argument_count()
    x = SIN(1.0 + i + j/k)
    x = SIN(REAL(j**k, 8) * 100) / 2.0
    CALL get_command_argument(i, arg)
    OPEN(7, FILE="output.txt")
    obj%attr = SIN(rr(1:i))
    name = adjustl(line(i)(1:pos-1)(0))
END PROGRAM

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      name: (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (call_expression
        (identifier)
        (argument_list)))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (call_expression
        (identifier)
        (argument_list
          (math_expression
            left: (math_expression
              left: (number_literal)
              (whitespace)
              (whitespace)
              right: (identifier))
            (whitespace)
            (whitespace)
            right: (math_expression
              left: (identifier)
              right: (identifier))))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (math_expression
        left: (call_expression
          (identifier)
          (argument_list
            (math_expression
              left: (call_expression
                (identifier)
                (argument_list
                  (math_expression
                    left: (identifier)
                    right: (identifier))
                  (whitespace)
                  (number_literal)))
              (whitespace)
              (whitespace)
              right: (number_literal))))
        (whitespace)
        (whitespace)
        right: (number_literal)))
    (end_of_statement)
    (whitespace)
    (subroutine_call
      (whitespace)
      subroutine: (identifier)
      (argument_list
        (identifier)
        (whitespace)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (open_statement
      (unit_identifier
        (number_literal))
      (whitespace)
      (keyword_argument
        name: (identifier)
        value: (prefixed_string_literal
          (string_literal))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (derived_type_member_expression
        (identifier)
        (type_member))
      (whitespace)
      (whitespace)
      right: (call_expression
        (identifier)
        (argument_list
          (call_expression
            (identifier)
            (argument_list
              (extent_specifier
                (number_literal)
                (identifier)))))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (call_expression
        (identifier)
        (argument_list
          (call_expression
            (call_expression
              (call_expression
                (identifier)
                (argument_list
                  (identifier)))
              (argument_list
                (extent_specifier
                  (number_literal)
                  (math_expression
                    left: (identifier)
                    right: (number_literal)))))
            (argument_list
              (number_literal))))))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Call Type-Bound Procedure
================================================================================

program use_type_bound_procedures
  call foo%bar()
  call foo(n)%bar%quux()
end program use_type_bound_procedures

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (subroutine_call
      (whitespace)
      (derived_type_member_expression
        (identifier)
        (type_member))
      (argument_list))
    (end_of_statement)
    (whitespace)
    (subroutine_call
      (whitespace)
      (derived_type_member_expression
        (derived_type_member_expression
          (call_expression
            (identifier)
            (argument_list
              (identifier)))
          (type_member))
        (type_member))
      (argument_list))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (whitespace)
      (name)
      (end_of_statement))))

================================================================================
Line Continuation
================================================================================

program test
    write(*, "('Testing line continuation')", &
       &  advance='no', &  ! Comment after line continuation
          iostat=istat, &  ! Comment followed by line continuation
       &  iomsg=imsg)
    ! Note trailing whitespace after line continuation on next line
    error &    
      stop
end program

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (write_statement
      (unit_identifier)
      (whitespace)
      (format_identifier
        (prefixed_string_literal
          (string_literal)))
      (whitespace)
      (whitespace)
      (whitespace)
      (keyword_argument
        (identifier)
        (prefixed_string_literal
          (string_literal)))
      (whitespace)
      (whitespace)
      (comment)
      (whitespace)
      (keyword_argument
        (identifier)
        (identifier))
      (whitespace)
      (whitespace)
      (comment)
      (whitespace)
      (whitespace)
      (keyword_argument
        (identifier)
        (identifier)))
    (end_of_statement)
    (whitespace)
    (comment)
    (whitespace)
    (stop_statement
      (whitespace)
      (whitespace)
      (whitespace))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Line Continuation in String Literal
================================================================================

program test
  print*, "hello &
    & world"
end program test

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (print_statement
      (format_identifier)
      (whitespace)
      (output_item_list
        (prefixed_string_literal
          (string_literal))))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (whitespace)
      (name)
      (end_of_statement))))

================================================================================
Line Continuation in Number Literals
================================================================================

program test
  real, parameter :: pi = &
    &3.14&
    &1592&
    &6535&
    &8979
  integer, dimension(2) :: foo = [1&
    , 2]
  real, dimension(2) :: foo = [1.e0&
    &, 2.e0]
end program

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (type_qualifier)
      (whitespace)
      (whitespace)
      (init_declarator
        (identifier)
        (whitespace)
        (whitespace)
        (whitespace)
        (ERROR
          (number_literal))
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (type_qualifier
        (argument_list
          (number_literal)))
      (whitespace)
      (whitespace)
      (init_declarator
        (identifier)
        (whitespace)
        (whitespace)
        (array_literal
          (ERROR
            (number_literal)
            (whitespace)
            (whitespace)
            (number_literal))
          (whitespace)
          (identifier)
          (whitespace)
          (call_expression
            (identifier)
            (argument_list
              (number_literal)))
          (whitespace)
          (ERROR
            (whitespace)
            (implicit_range_letter)
            (implicit_range_letter)
            (implicit_range_letter)
            (whitespace))
          (whitespace)
          (ERROR
            (ERROR
              (number_literal))
            (user_defined_operator_name)
            (number_literal))
          (whitespace)
          (whitespace)
          (number_literal))))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement))))

================================================================================
Array Constructors
================================================================================

program array_constructors
  implicit none
  integer :: i
  integer, dimension(3) :: array1 = (/ (i, i=1, 3) /), array2 = [(j, integer(kind=8)::j=1,64)]
  real, dimension(10) :: array2

  array2 = [((real(i - 1) / 10.), i=1, 10)]
  array2 = [real::]

  print*, sin([real(real64)::1., 2., 3., 4.])
  print*, sin((/1., 2., 3., 4./))
  print*, [character(len=3) :: "foo", "fo", "f"]
end program array_constructors

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (implicit_statement
      (whitespace)
      (none))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (type_qualifier
        (argument_list
          (number_literal)))
      (whitespace)
      (whitespace)
      (init_declarator
        (identifier)
        (whitespace)
        (whitespace)
        (array_literal
          (whitespace)
          (implied_do_loop_expression
            (identifier)
            (whitespace)
            (loop_control_expression
              (identifier)
              (number_literal)
              (whitespace)
              (number_literal)))
          (whitespace)))
      (whitespace)
      (init_declarator
        (identifier)
        (whitespace)
        (whitespace)
        (array_literal
          (implied_do_loop_expression
            (identifier)
            (whitespace)
            (intrinsic_type
              (kind
                (keyword_argument
                  (identifier)
                  (number_literal))))
            (loop_control_expression
              (identifier)
              (number_literal)
              (number_literal))))))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (type_qualifier
        (argument_list
          (number_literal)))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (array_literal
        (implied_do_loop_expression
          (parenthesized_expression
            (math_expression
              (call_expression
                (identifier)
                (argument_list
                  (math_expression
                    (identifier)
                    (whitespace)
                    (whitespace)
                    (number_literal))))
              (whitespace)
              (whitespace)
              (number_literal)))
          (whitespace)
          (loop_control_expression
            (identifier)
            (number_literal)
            (whitespace)
            (number_literal)))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (array_literal
        (intrinsic_type)))
    (end_of_statement)
    (whitespace)
    (print_statement
      (format_identifier)
      (whitespace)
      (output_item_list
        (call_expression
          (identifier)
          (argument_list
            (array_literal
              (intrinsic_type
                (kind
                  (identifier)))
              (number_literal)
              (whitespace)
              (number_literal)
              (whitespace)
              (number_literal)
              (whitespace)
              (number_literal))))))
    (end_of_statement)
    (whitespace)
    (print_statement
      (format_identifier)
      (whitespace)
      (output_item_list
        (call_expression
          (identifier)
          (argument_list
            (array_literal
              (number_literal)
              (whitespace)
              (number_literal)
              (whitespace)
              (number_literal)
              (whitespace)
              (number_literal))))))
    (end_of_statement)
    (whitespace)
    (print_statement
      (format_identifier)
      (whitespace)
      (output_item_list
        (array_literal
          (intrinsic_type
            (kind
              (keyword_argument
                (identifier)
                (number_literal))))
          (whitespace)
          (whitespace)
          (prefixed_string_literal
            (string_literal))
          (whitespace)
          (prefixed_string_literal
            (string_literal))
          (whitespace)
          (prefixed_string_literal
            (string_literal)))))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (whitespace)
      (name)
      (end_of_statement))))

================================================================================
Keywords As Identifiers
================================================================================

program demo
   integer :: endif, if, elseif, error
   integer, DIMENSION(2) :: function
   endif = 3; if = 2
   error = 1
   if (endif == 2) then
      endif = 5
      elseif = if + endif
   elseif (endif == 3) then
      function(if) = endif/elseif
      print *, endif
   endif
end program

subroutine foo
  integer :: if(1), elseif, else, format(1)
  character(len=32) :: format
  character(len=1) :: width
  format(7:9) = width//'.'//width
  if(1) = 5
end subroutine foo

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (whitespace)
      (identifier)
      (whitespace)
      (identifier)
      (whitespace)
      (identifier)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (type_qualifier
        (argument_list
          (number_literal)))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (whitespace)
    (if_statement
      (block_if_statement
        (whitespace)
        (parenthesized_expression
          (relational_expression
            (identifier)
            (whitespace)
            (whitespace)
            (number_literal)))
        (whitespace)
        (end_of_statement)
        (whitespace)
        (assignment_statement
          (identifier)
          (whitespace)
          (whitespace)
          (number_literal))
        (end_of_statement)
        (whitespace)
        (assignment_statement
          (identifier)
          (whitespace)
          (whitespace)
          (math_expression
            (identifier)
            (whitespace)
            (whitespace)
            (identifier)))
        (end_of_statement)
        (whitespace)
        (elseif_clause
          (whitespace)
          (parenthesized_expression
            (relational_expression
              (identifier)
              (whitespace)
              (whitespace)
              (number_literal)))
          (whitespace)
          (end_of_statement)
          (whitespace)
          (assignment_statement
            (call_expression
              (identifier)
              (argument_list
                (identifier)))
            (whitespace)
            (whitespace)
            (math_expression
              (identifier)
              (identifier)))
          (end_of_statement)
          (whitespace)
          (print_statement
            (whitespace)
            (format_identifier)
            (whitespace)
            (output_item_list
              (identifier)))
          (end_of_statement))
        (whitespace)
        (end_if_statement)))
    (end_of_statement)
    (end_program_statement
      (whitespace)
      (end_of_statement)))
  (subroutine
    (subroutine_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (whitespace)
      (sized_declarator
        (identifier)
        (size
          (number_literal)))
      (whitespace)
      (identifier)
      (whitespace)
      (identifier)
      (whitespace)
      (sized_declarator
        (identifier)
        (size
          (number_literal))))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type
        (kind
          (keyword_argument
            (identifier)
            (number_literal))))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type
        (kind
          (keyword_argument
            (identifier)
            (number_literal))))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (extent_specifier
            (number_literal)
            (number_literal))))
      (whitespace)
      (whitespace)
      (concatenation_expression
        (identifier)
        (concatenation_expression
          (prefixed_string_literal
            (string_literal))
          (identifier))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (number_literal)))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (end_subroutine_statement
      (whitespace)
      (whitespace)
      (name)
      (end_of_statement))))

================================================================================
Conditional expressions
================================================================================

subroutine test(a, b)
  integer, intent(in) :: a
  integer, optional, intent(in) :: b
  a = present(b) ? b : 1
  call sub(a > 2 ? a : .nil.)
end subroutine test

--------------------------------------------------------------------------------

(translation_unit
  (subroutine
    (subroutine_statement
      (whitespace)
      name: (name)
      parameters: (parameters
        (identifier)
        (whitespace)
        (identifier))
      (end_of_statement))
    (whitespace)
    (variable_declaration
      type: (intrinsic_type)
      (whitespace)
      attribute: (type_qualifier)
      (whitespace)
      (whitespace)
      declarator: (identifier))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      type: (intrinsic_type)
      (whitespace)
      attribute: (type_qualifier)
      (whitespace)
      attribute: (type_qualifier)
      (whitespace)
      (whitespace)
      declarator: (identifier))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      left: (identifier)
      (whitespace)
      (whitespace)
      right: (conditional_expression
        condition: (call_expression
          (identifier)
          (argument_list
            (identifier)))
        (whitespace)
        (whitespace)
        consequence: (identifier)
        (whitespace)
        (whitespace)
        alternative: (number_literal)))
    (end_of_statement)
    (whitespace)
    (subroutine_call
      (whitespace)
      subroutine: (identifier)
      (argument_list
        (conditional_expression
          condition: (relational_expression
            left: (identifier)
            (whitespace)
            (whitespace)
            right: (number_literal))
          (whitespace)
          (whitespace)
          consequence: (identifier)
          (whitespace)
          (whitespace)
          alternative: (nil_literal))))
    (end_of_statement)
    (end_subroutine_statement
      (whitespace)
      (whitespace)
      (name)
      (end_of_statement))))

================================================================================
Multiple subscripts
================================================================================

program test
  b = A(@[3,5])       ! Array element, equivalent to A(3, 5)
  b = A(6, @[3,5], 1) ! Array element, equivalent to A(6, 3, 5, 1)
  b = A(@V1, :, @V2)  ! Rank-one array section, the rank of A being
                      ! SIZE (V1) + 1 + SIZE (V2).
  b = A(@[3,5]:[9,10]:[2,3]) ! Equivalent to A(3:9:2, 5:10:3)
  b = A(@[3,5]:[9,10]:2) ! Equivalent to A(3:9:2, 5:10:2)
  b = A(@[3,5]:[9,10]) ! Equivalent to A(3:9, 5:10)
end program test

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (call_expression
        (identifier)
        (argument_list
          (multiple_subscript
            (array_literal
              (number_literal)
              (number_literal))))))
    (whitespace)
    (end_of_statement)
    (comment)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (call_expression
        (identifier)
        (argument_list
          (number_literal)
          (whitespace)
          (multiple_subscript
            (array_literal
              (number_literal)
              (number_literal)))
          (whitespace)
          (number_literal))))
    (whitespace)
    (end_of_statement)
    (comment)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (call_expression
        (identifier)
        (argument_list
          (multiple_subscript
            (identifier))
          (whitespace)
          (extent_specifier)
          (whitespace)
          (multiple_subscript
            (identifier)))))
    (whitespace)
    (end_of_statement)
    (comment)
    (whitespace)
    (comment)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (call_expression
        (identifier)
        (argument_list
          (multiple_subscript_triplet
            (array_literal
              (number_literal)
              (number_literal))
            (array_literal
              (number_literal)
              (number_literal))
            (array_literal
              (number_literal)
              (number_literal))))))
    (whitespace)
    (end_of_statement)
    (comment)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (call_expression
        (identifier)
        (argument_list
          (multiple_subscript_triplet
            (array_literal
              (number_literal)
              (number_literal))
            (array_literal
              (number_literal)
              (number_literal))
            (number_literal)))))
    (whitespace)
    (end_of_statement)
    (comment)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (call_expression
        (identifier)
        (argument_list
          (multiple_subscript_triplet
            (array_literal
              (number_literal)
              (number_literal))
            (array_literal
              (number_literal)
              (number_literal))))))
    (whitespace)
    (end_of_statement)
    (comment)
    (end_program_statement
      (whitespace)
      (whitespace)
      (name)
      (end_of_statement))))

================================================================================
Reserved keyword as a symbol name
================================================================================

program main
  integer :: allocatable(10, 20)
  allocatable(1, 1) = 0
end

--------------------------------------------------------------------------------

(translation_unit
  (program
    (program_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (whitespace)
      (sized_declarator
        (identifier)
        (size
          (number_literal)
          (whitespace)
          (number_literal))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (call_expression
        (identifier)
        (argument_list
          (number_literal)
          (whitespace)
          (number_literal)))
      (whitespace)
      (whitespace)
      (number_literal))
    (end_of_statement)
    (end_program_statement
      (end_of_statement))))

================================================================================
Valid statements with prefixed strings
================================================================================

subroutine foo()
  integer, parameter :: k = 4
  character(len=128, kind=k) :: baz

  data baz / k_"baz" /

  open(unit=1, file=1_"mux")

  baz = k_"bux"
  pause 1_"fux"
end

--------------------------------------------------------------------------------

(translation_unit
  (subroutine
    (subroutine_statement
      (whitespace)
      (name)
      (end_of_statement))
    (whitespace)
    (variable_declaration
      (intrinsic_type)
      (whitespace)
      (type_qualifier)
      (whitespace)
      (whitespace)
      (init_declarator
        (identifier)
        (whitespace)
        (whitespace)
        (number_literal)))
    (end_of_statement)
    (whitespace)
    (variable_declaration
      (intrinsic_type
        (kind
          (keyword_argument
            (identifier)
            (number_literal))
          (whitespace)
          (keyword_argument
            (identifier)
            (identifier))))
      (whitespace)
      (whitespace)
      (identifier))
    (end_of_statement)
    (whitespace)
    (data_statement
      (whitespace)
      (data_set
        (identifier)
        (whitespace)
        (data_value
          (whitespace)
          (prefixed_string_literal
            (identifier)
            (string_literal))
          (whitespace))))
    (end_of_statement)
    (whitespace)
    (open_statement
      (unit_identifier
        (number_literal))
      (whitespace)
      (keyword_argument
        (identifier)
        (prefixed_string_literal
          (number_literal)
          (string_literal))))
    (end_of_statement)
    (whitespace)
    (assignment_statement
      (identifier)
      (whitespace)
      (whitespace)
      (prefixed_string_literal
        (identifier)
        (string_literal)))
    (end_of_statement)
    (whitespace)
    (file_position_statement
      (whitespace)
      (prefixed_string_literal
        (number_literal)
        (string_literal)))
    (end_of_statement)
    (end_subroutine_statement
      (end_of_statement))))
